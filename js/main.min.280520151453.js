var Loader=function(){};Loader.prototype={require:function(a,c){this.loadCount=0;this.totalRequired=a.length;this.callback=c;for(var b=0;b<a.length;b++){this.writeScript(a[b])}},loaded:function(a){this.loadCount++;if(this.loadCount==this.totalRequired&&typeof this.callback=="function"){this.callback.call()}},writeScript:function(d){var a=this;var b=document.createElement("script");b.type="text/javascript";b.async=true;b.src=d;if(b.addEventListener){b.addEventListener("load",function(f){a.loaded(f)},false)}else{b.onreadystatechange=function(f){if(b.readyState in {loaded:1,complete:1}){b.onreadystatechange=null;a.loaded(f)}}}var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}};var FORMAT_DATE="dd/mm/yyyy";var FORMAT_DATE_CALENDAR="dd/mm/yy";var dateFormat=function(b){pad=function(f,d){f=String(f);d=d||2;while(f.length<d){f="0"+f}return f};var c=b.getDate();var a=b.getMonth();a++;var e=b.getFullYear();return pad(c)+"/"+pad(a)+"/"+e};var get_JS_Date=function(a){var b=a.split("/");return new Date(parseInt(b[2],10),[parseInt(b[1],10)-1],parseInt(b[0],10),0,0,0,0)};function check_date(d){var a=/^\d{2}\/\d{2}\/\d{4}$/;var g=false;if(!a.test(d)){return false}else{var b=d.split("/")[0];var f=d.split("/")[1];var c=d.split("/")[2];var e=new Date(c,f-1,b);if((e.getMonth()+1!=f)||(e.getDate()!=b)||(e.getFullYear()!=c)){g=false}else{g=true}}if(g==false){input.select()}return g}function init_flight_search(){$("#btn_flight_departure_date").click(function(){$("#flight_departure_date").focus()});$("#btn_flight_returning_date").click(function(){$("#flight_returning_date").focus()})}function set_up_flight_calendar(a){if(typeof a!=="undefined"&&a){a=true}else{a=false}set_up_calendar("#flight_departure_date",function(e,d){$("#flight_departure_date").removeClass("bpv-input-warning");var c=$(this).datepicker("getDate");var b=$("#flight_returning_date").datepicker("getDate");if(!a){if(b!=null&&b<=c){$("#flight_returning_date").datepicker("setDate",e);setTimeout(function(){$("#flight_returning_date").datepicker("show")},100)}}},a);set_up_calendar("#flight_returning_date",function(e,d){$("#flight_returning_date").removeClass("bpv-input-warning");$("#delete_return").show();if($("#flight_type").length>0){$("input[name=Type][value=roundway]").prop("checked",true)}var c=$("#flight_departure_date").datepicker("getDate");var b=$(this).datepicker("getDate");if(!a){if(c!=null&&b<=c){$("#flight_departure_date").datepicker("setDate",e);setTimeout(function(){$("#flight_departure_date").datepicker("show")},100)}}},a)}function delete_flight_return(){$("#flight_returning_date").removeClass("bpv-input-warning");$("#flight_returning_date").val("");$("#delete_return").hide();if($("#flight_type").length>0){$("input[name=Type][value=oneway]").prop("checked",true)}}function select_flight_type(){var a=$('input[name="Type"]:checked').val();if(a=="oneway"){delete_flight_return()}}function check_search_type(){var a=$('input[name="search_type"]:checked').val();if(a==0){$("#tab_search_hotel").show();$("#tab_search_flight").hide();$("#tab_search_tour").hide()}else{if(a==1){$("#tab_search_hotel").hide();$("#tab_search_flight").show();$("#tab_search_tour").hide()}else{$("#tab_search_hotel").hide();$("#tab_search_flight").hide();$("#tab_search_tour").show()}}$("#search_label").text($("#txt_search_label_"+a).text())}function validate_flight_search(){var f=$("#flight_from");var e=$("#flight_to");if($.trim(f.val())==""){alert('Xin vui lòng nhập "Điểm Đi"');$(f).focus();$(f).addClass("bpv-input-warning");return false}if($.trim(e.val())==""){alert('Xin vui lòng nhập "Điểm Đến"');$(e).focus();$(e).addClass("bpv-input-warning");return false}var d=$("#flight_departure_date").val();var c=$("#flight_returning_date").val();if($.trim(d)==""){alert('Xin vui lòng nhập "Ngày đi"');$("#flight_departure_date").focus();$("#flight_departure_date").addClass("bpv-input-warning");return false}if(!check_date(d)){alert('"Ngày đi" phải theo định dạng '+FORMAT_DATE);$("#flight_departure_date").focus();$("#flight_departure_date").addClass("bpv-input-warning");return false}var b=new Date();b=dateFormat(b);if(get_JS_Date(d)<get_JS_Date(b)){alert('"Ngày đi" không được phép là ngày trong quá khứ!');$("#flight_departure_date").focus();$("#flight_departure_date").addClass("bpv-input-warning");return false}if(c!=""&&!check_date(c)){alert('"Ngày về" phải theo định dạng '+FORMAT_DATE);$("#flight_returning_date").focus();$("#flight_returning_date").addClass("bpv-input-warning");return false}if(c!=""&&get_JS_Date(d)>get_JS_Date(c)){alert('Vui lòng nhập "Ngày về" lớn hơn hoặc bằng "Ngày đi"');$("#flight_returning_date").focus();$("#flight_returning_date").addClass("bpv-input-warning");return false}if($("#flight_type").length>0){var a=$('input[name="Type"]:checked').val();if(a=="roundway"){if($.trim(c)==""){alert('Bạn đang tìm kiếm chuyến bay khứ hồi. Xin vui lòng nhập "Ngày về"');$("#flight_returning_date").focus();$("#flight_returning_date").addClass("bpv-input-warning");return false}}}return true}function validate_flight_search_dialog(){var c=$("#flight_dialog_departure_date").val();var b=$("#flight_dialog_returning_date").val();if($.trim(c)==""){alert('Xin vui lòng nhập "Ngày đi"');$("#flight_dialog_departure_date").focus();$("#flight_dialog_departure_date").addClass("bpv-input-warning");return false}if(!check_date(c)){alert('"Ngày đi" phải theo định dạng '+FORMAT_DATE);$("#flight_dialog_departure_date").focus();$("#flight_dialog_departure_date").addClass("bpv-input-warning");return false}var a=new Date();a=dateFormat(a);if(get_JS_Date(c)<get_JS_Date(a)){alert('"Ngày đi" không được phép là ngày trong quá khứ!');$("#flight_dialog_departure_date").focus();$("#flight_dialog_departure_date").addClass("bpv-input-warning");return false}if(b!=""&&!check_date(b)){alert('"Ngày về" phải theo định dạng '+FORMAT_DATE);$("#flight_dialog_returning_date").focus();$("#flight_dialog_returning_date").addClass("bpv-input-warning");return false}if(b!=""&&get_JS_Date(c)>get_JS_Date(b)){alert('Vui lòng nhập "Ngày về" lớn hơn hoặc bằng "Ngày đi"');$("#flight_dialog_returning_date").focus();$("#flight_dialog_returning_date").addClass("bpv-input-warning");return false}return true}function init_hotel_date(e,g,f,b,a){var c=new Date();c=dateFormat(c);if(a!=""&&a!=undefined){$(e).val(a)}get_check_out_date(e,g,f,b);$(e).change(function(){get_check_out_date(e,g,f,b)});$(g).change(function(){get_check_out_date(e,g,f,b)});var d="#btn_"+e.replace("#","");$(d).click(function(){$(e).focus()})}function init_hotel_search(b,a){if(typeof a!=="undefined"&&a){a=true}else{a=false}if(b==undefined){b=false}if(b){get_current_search(1)}init_hotel_date("#startdate","#night","#enddate","#show_search_end_date","");if($("#destination").parent().find(".search-choice-close").length==0&&$("#destination").val()!=""&&!a){add_clear_search("#destination")}$("#destination").blur(function(){if($.trim($("#destination").val())!=""&&!a){add_clear_search("#destination")}});$("#destination").on("input",function(){if($.trim($("#destination").val())!=$("#destination").data("selected_value")){$("#hotel_destination_input").val("");$("#oid").val("");$(".search-choice-close").remove();$("#destination").popover("hide")}});check_search_type();$("#destination").popover({html:true,trigger:"click",template:'<div class="popover suggestion-des"><div class="arrow"></div><div class="popover-inner"><div class="popover-content"><p></p></div></div></div>',content:$("#suggestion-des").html(),placement:"right"}).on("shown.bs.popover",function(c){$(".suggestion-des a").click(function(){$("#destination").val($(this).attr("data-name"));$(".typeahead").typeahead("val",$(this).attr("data-name"));$("#hotel_destination_input").val($(this).attr("data-url-title"));$("#oid").val("d-"+$(this).attr("data-id"));$("#destination").data("selected_value",$("#destination").val());add_clear_search("#destination");$("#destination").popover("hide");$(".typeahead").typeahead("close")})})}function set_up_calendar(b,c,a){var d=2;if(typeof a!=="undefined"&&a){a=true;d=1}else{a=false}if(c==undefined&&typeof c!="function"){c=null}$(b).datepicker({numberOfMonths:d,closeText:"Đóng",currentText:"Hôm nay",showButtonPanel:a,minDate:0,monthNames:["Tháng 1","Tháng 2","Tháng 3","Tháng 4","Tháng 5","Tháng 6","Tháng 7","Tháng 8","Tháng 9","Tháng 10","Tháng 11","Tháng 12"],dayNames:["CN","T2","T3","T4","T5","T6","T7"],dayNamesMin:["CN","T2","T3","T4","T5","T6","T7"],dateFormat:FORMAT_DATE_CALENDAR,onSelect:c});if(a){$(b).on("focus",function(e){$(this).trigger("blur")})}}function set_up_hotel_calendar(a){if(typeof a!=="undefined"&&a){a=true}else{a=false}if($("#startdate").length>0){set_up_calendar("#startdate",null,a)}if($("#checkin_date").length>0){set_up_calendar("#checkin_date",null,a)}}function set_up_hotel_autocomplete(c){if(typeof c!=="undefined"&&c){c=true}else{c=false}var b=new Bloodhound({datumTokenizer:function(e){return Bloodhound.tokenizers.whitespace(e.name)},queryTokenizer:Bloodhound.tokenizers.whitespace,remote:{url:"/suggest_hotel_destinations/?query=%QUERY"}});var a=new Bloodhound({datumTokenizer:function(e){return Bloodhound.tokenizers.whitespace(e.name)},queryTokenizer:Bloodhound.tokenizers.whitespace,remote:{url:"/suggest_hotels/?query=%QUERY"}});b.initialize();a.initialize();$("#destination").typeahead({minLength:2,highlight:true,hint:false},{displayKey:"name",source:b.ttAdapter(),templates:{header:'<span class="lb-header">Tỉnh/Thành Phố/Địa danh</span>'}},{displayKey:"name",source:a.ttAdapter(),templates:{header:'<span class="lb-header">Khách Sạn</span>'}}).on("typeahead:selected",function(e,d){$("#hotel_destination_input").val(d.url_title);$("#oid").val(d.type+"-"+d.id);$("#destination").data("selected_value",$("#destination").val());if(!c){add_clear_search("#destination")}$("#destination").popover("hide")})}function add_clear_search(b){if($(b).parent().find(".search-choice-close").length==0){var a=$('<span class="icon btn-search-close search-choice-close"></span>');$(b).parent().append(a);a.click(function(){clear_search(b)})}}function clear_search(a){$(a).val("");$(a).focus();$(a).parent().find(".typeahead").typeahead("val","");$(a).parent().parent().find(".search-choice-close").remove();if(a=="#destination"){$("#oid").val("");$("#hotel_destination_input").val("")}if(a=="#tour_destination"){$("#des_id").val("")}}function get_check_out_date(d,f,e,b){var c=$(d).val();if(check_date(c)){var a=get_JS_Date(c);var g=$(f).val();a.setDate(a.getDate()+parseInt(g,10));if(check_date(dateFormat(a))){$(b).html(dateFormat(a));$(e).val(dateFormat(a));if($("#enddate_lbl").length>0){$("#enddate_lbl").show()}}}}function validate_hotel_search(){if($.trim($("#destination").val())==""){alert("Xin vui lòng nhập Tỉnh/Thành Phố/Điểm Du Lịch/Tên Khách Sạn");$("#destination").focus();$("#destination").addClass("bpv-input-warning");return false}var a=$("#startdate").val();if($.trim(a)==""){$("#startdate").focus();$("#startdate").addClass("bpv-input-warning");alert('Xin vui lòng nhập thông tin "Ngày nhận phòng"');return false}if(!check_date(a)){$("#startdate").focus();$("#startdate").addClass("bpv-input-warning");alert('"Ngày nhận phòng" phải theo định dạng '+FORMAT_DATE);return false}return true}function not_interested(a){$.ajax({url:"/remove_recent_item/",type:"POST",cache:true,data:{item_id:a},success:function(c){}});if($("#ritem-"+a).prev().length>0){$("#ritem-"+a).prev().addClass("no-border")}$("#ritem-"+a).remove();var b=$("#box_recent_items .bpt-list-sm").length;if(b<1){$("#box_recent_items").remove()}}function bpv_format_currency(c,d){c=c.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1.");if(c.length>3){var b=c.substring(0,c.length-3);var a=c.substring(c.length-3,c.length);c=b+"<small>"+a+" "+d+"</small>"}return c}function go_url(a){window.location=a}function go_check_rate_position(){$("html, body").animate({scrollTop:$(".bpv-check-rate-form").offset().top},"fast")}function go_position(a){$("html, body").animate({scrollTop:a},"fast")}function get_url_var(b,c){var a=new RegExp(b+"=([^&]*)","i").exec(c);return a&&unescape(a[1])||""}function show_more_photos(){var b=$("#show_more_photos").attr("show");var a=$("#show_more_photos").text();if(b=="hide"){$(".more-photos").show();$("#show_more_photos").attr("show","show");a=a.replace("[+]","[-]")}else{$(".more-photos").hide();$("#show_more_photos").attr("show","hide");a=a.replace("[+]","[-]")}$("#show_more_photos").text(a)}function show_more_rooms(){var b=$("#show_more_rooms").attr("show");var a=$("#show_more_rooms").text();if(b=="hide"){$(".more-rooms").show();$("#show_more_rooms").attr("show","show");a=a.replace("[+]","[-]")}else{$(".more-rooms").hide();$("#show_more_rooms").attr("show","hide");a=a.replace("[-]","[+]")}$("#show_more_rooms").text(a)}function show_more(c){var b=$(c).attr("show");var a=$(c).text();if(b=="hide"){$(".hidden-item").show();$(c).attr("show","show");a=a.replace("[+]","[-]")}else{$(".hidden-item").hide();$(c).attr("show","hide");a=a.replace("[+]","[-]")}$(c).text(a)}function change_search(){$(".bpv-search-overview").hide();$(".bpv-search-left").show()}function is_valid_email(a){var b=/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;if(!b.test(a)){return false}else{return true}}function validate_contact_form(){var c=true;$(".bpv-contact .warning-message").hide();$(".bpv-contact input").removeClass("bpv-input-warning");$(".bpv-contact select").removeClass("bpv-input-warning");if($.trim($("#gender").val())==""){$("#gender").addClass("bpv-input-warning");$("#title_required").show();c=false}if($.trim($("#name").val())==""){$("#name").addClass("bpv-input-warning");$("#name_required").show();c=false}if($.trim($("#email").val())==""){$("#email").addClass("bpv-input-warning");$("#email_required").show();c=false}else{if(!is_valid_email($("#email").val())){$("#email").addClass("bpv-input-warning");$("#email_valid").show();c=false}}var a=$.trim($("#c_day").val());var e=$.trim($("#c_month").val());var d=$.trim($("#c_year").val());var b=a!=""||e!=""||d!="";if(b){if(a==""||e==""||d==""){$("#birthday_valid").show();c=false}if(a==""){$("#c_day").addClass("bpv-input-warning")}if(e==""){$("#c_month").addClass("bpv-input-warning")}if(d==""){$("#c_year").addClass("bpv-input-warning")}}if($.trim($("#phone").val())==""){$("#phone").addClass("bpv-input-warning");$("#phone_required").show();c=false}if($.trim($("#phone_cf").val())==""){$("#phone_cf").addClass("bpv-input-warning");$("#phone_cf_required").show();c=false}else{if($("#phone_cf").val()!=$("#phone").val()){$("#phone_cf").addClass("bpv-input-warning");$("#phone_cf_valid").show();c=false}}if(!c){go_position($(".bpv-contact").offset().top)}else{if($("#payment_method").length>0){var f=$("#payment_method").val();if(f==""){alert("Xin vui lòng lựa chọn hình thức thanh toán.");c=false;go_position($(".bpv-payment-methods").offset().top)}}if(c&&$("#submit_data_waiting").length>0){$("#submit_data_waiting").modal()}}return c}function init_payment_detail(){$(".right-fixed").width($(".bpv-col-left").width());var a=$("#pro_code").val();if($.trim(a)!=""){$("#pro_use").show()}else{$("#pro_use").hide()}$("#pro_code").keyup(function(){var b=$("#pro_code").val();if($.trim(b)!=""){$("#pro_use").show();$("#pro_use_2").show()}else{$("#pro_use").hide();$("#pro_use_2").hide()}$("#pro_code_2").val(b)});$("#pro_code_2").keyup(function(){var b=$("#pro_code_2").val();if($.trim(b)!=""){$("#pro_use").show();$("#pro_use_2").show()}else{$("#pro_use").hide();$("#pro_use_2").hide()}$("#pro_code").val(b)});$("#pro_phone").keyup(function(){var b=$("#pro_phone").val();$("#pro_phone_2").val(b);$("#phone").val(b);$("#phone_cf").val(b)});$("#pro_phone_2").keyup(function(){var b=$("#pro_phone_2").val();$("#pro_phone").val(b);$("#phone").val(b);$("#phone_cf").val(b)})}function use_pro_code(g){reset_pro_code_discount(g);$("#code_invalid").hide();$("#code_ok").hide();$("#code_invalid_2").hide();$("#code_ok_2").hide();var f=$.trim($("#pro_code").val());var d=$("#pro_hotel").val();var b=$("#pro_cruise").val();var a=$("#pro_tour").val();var e=$("#pro_nr_passengers").val();var c=$.trim($("#pro_phone").val());if(/^[a-zA-Z0-9- ]*$/.test(f)==false||f==""){$("#code_invalid").show();$("#code_invalid_2").show()}else{$("#pro_use").button("loading");$("#pro_use_2").button("loading");$.ajax({url:"/apply-promotion-code/",type:"POST",cache:false,dataType:"json",data:{service_type:g,pro_code:f,hotel_id:d,cruise_id:b,tour_id:a,nr_passengers:e,pro_phone:c},success:function(h){$("#pro_use").button("reset");$("#pro_use_2").button("reset");if(h.invalid_phone){$(".pro_phone_block").show();$(".pro_phone_invalid").show();$(".pro_phone_invalid_msg").html(h.invalid_phone);return false}else{$(".pro_phone_invalid").hide()}if(h==""){$("#code_invalid").show();$("#code_invalid_2").show()}else{update_booking_payment(h,f,g)}},error:function(j,i,h){$("#code_invalid").show();$("#pro_use").button("reset");$("#code_invalid_2").show();$("#pro_use_2").button("reset")}})}}function update_booking_payment(i,h,f){var j=0;if(i.discount_type==2){j=i.get}if(i.discount_type==3){var a=i.get;var c=$("#nr_ticket").val();if(c==undefined||c==""){c=0}else{c=parseInt(c)}j=a*c}if(i.discount_type==4){var a=i.get;var d=$("#nr_pax").val();if(d==undefined||d==""){d=0}else{d=parseInt(d)}j=a*d}if(i.discount_type==1){var a=i.get;var g=i.get_max;var e=0;if(f==1){e=update_hotel_total_payment("đ")}if(f==2){e=update_flight_total_payment("đ")}if(f==3){e=update_cruise_total_payment("đ")}if(f==4){e=update_tour_total_payment("đ")}var j=e*a/100;if(j>g&&g>0){j=g}j=Math.round(j/1000)*1000}$("#applied_code_discount").attr("rate",j);$("#applied_code_discount").html("- "+bpv_format_currency(j,"đ"));$("#applied_code").text(h);if(j>0){$("#p_applied_code").show()}var b='<span class="glyphicon glyphicon-ok"></span>';if(j>0){b=b+"&nbsp; Đã giảm giá <b>"+bpv_format_currency(j,"đ")+"</b>."}if(i.discount_note!=undefined&&i.discount_note!=""){b=b+"&nbsp; "+i.discount_note}$("#code_ok").html(b);$("#code_ok").show();$("#code_ok_2").html(b);$("#code_ok_2").show();$("#promotion_code_used").val(h);if(f==1){update_hotel_total_payment("đ")}if(f==2){update_flight_total_payment("đ")}if(f==3){update_cruise_total_payment("đ")}if(f==4){update_tour_total_payment("đ")}return j}function reset_pro_code_discount(a){$("#applied_code_discount").attr("rate",0);$("#p_applied_code").hide();$("#promotion_code_used").val("");if(a==1){update_hotel_total_payment("đ")}if(a==2){update_flight_total_payment("đ")}if(a==3){update_cruise_total_payment("đ")}if(a==4){update_tour_total_payment("đ")}}function send_contact_request(c){var d=$(c).attr("data-id");var b=["groupon_request","groupon_email","groupon_phone_number"];var a=true;$.each(b,function(f,g){var e=$("#"+g).val();if(e==""||(g=="groupon_email"&&!IsEmail(e))||(g=="groupon_phone_number"&&!IsPhone(e))){$("#"+g).focus();$("#"+g).addClass("bpv-input-warning");$(".er_"+g).removeClass("hide");a=false}else{$("#"+g).removeClass("bpv-input-warning");$(".er_"+g).addClass("hide")}});if(a){$("#"+d+"_hd").button("loading");$("#"+d+"_form").addClass("hide");$("#"+d+"_waiting").removeClass("hide");$.ajax({url:"/groupon_request/",type:"POST",data:{groupon_request:$("#groupon_request").val(),groupon_email:$("#groupon_email").val(),groupon_phone_number:$("#groupon_phone_number").val(),groupon_pop_type:$("#popup_type").val()},success:function(e){$("#"+d+"_hd").button("reset");$("#"+d+"_waiting").addClass("hide");$("#"+d+"_success").removeClass("hide");setTimeout(function(){$("#"+d).popover("hide")},10000)},error:function(g,f,e){$("#"+d+"_hd").button("reset");alert("Có lỗi kết nối mạng, yêu cầu của quý khách không thể gửi đi, xin quý khách vui lòng gọi đến số 04 3978 1425 để gặp trực tiếp nhân viên của chúng tôi.");$("#"+d).popover("hide")}})}}function send_tour_contact_request(g){var h=$(g).attr("id");var d=$("#tour_request_email").val();var b=$("#tour_request_phone").val();var f=$("#adults").val();var c=$("#children").val();var e=$("#infants").val();var a=$("#tour_request_content").val();$("#tour_request_email").removeClass("bpv-input-warning");$("#tour_request_phone").removeClass("bpv-input-warning");$(".er_tour_request_email").addClass("hide");$(".er_tour_request_phone").addClass("hide");if(IsEmail(d)&&IsPhone(b)){return true}else{if(!IsEmail(d)&&IsPhone(b)){$("#tour_request_email").focus();$("#tour_request_email").addClass("bpv-input-warning");$(".er_tour_request_email").removeClass("hide");$(".er_tour_request_email").html("Bạn cần nhập đúng thông tin <b>[Email]</b> ");return false}else{if(IsEmail(d)&&!IsPhone(b)){$("#tour_request_phone").focus();$("#tour_request_phone").addClass("bpv-input-warning");$(".er_tour_request_phone").removeClass("hide");return false}else{$("#tour_request_email").focus();$("#tour_request_email").addClass("bpv-input-warning");$(".er_tour_request_email").removeClass("hide");$("#tour_request_phone").focus();$("#tour_request_phone").addClass("bpv-input-warning");$(".er_tour_request_phone").removeClass("hide");return false}}}}function send_news_letter_request(b){var c=$(b).attr("id");var a=$("#newsletter_to").val();if(IsEmail(a)){$("#newsletter").button("loading");$("#newsletter").html("Đang xử lý");$.ajax({url:"/news-letter-request/",type:"POST",data:{news_letter_to:a},success:function(d){if(d==1||d==2){$("#newsletter").button("reset");$("#newsletter_to").attr("readonly","1");$("#newsletter_to").removeClass("bpv-input-warning");$("#newsletter_to").val("");$("#newsletter").css("margin-top","27px");$(".bpv-register").css("height","90px");$("#newsletter_invalid").addClass("hide");$("#newsletter_ok").removeClass("hide")}else{if(d==3){$("#newsletter").button("reset");$("#newsletter_to").focus();$("#newsletter_to").addClass("bpv-input-warning");$("#newsletter_invalid").removeClass("hide");$("#newsletter").css("margin-top","27px");$(".bpv-register").css("height","90px")}}},error:function(f,e,d){$("#newsletter").button("reset");alert("Quý khách hãy nhấn lại đăng ký.")}})}else{$("#newsletter_to").focus();$("#newsletter_to").addClass("bpv-input-warning");$("#newsletter_invalid").removeClass("hide");$("#newsletter").css("margin-top","27px");$(".bpv-register").css("height","90px")}}function send_sign_up_request(c){var d=$(c).attr("data-id");$("#"+d+"_success").addClass("hide");$("#sign_up_email").removeClass("bpv-input-warning");$("#sign_up_phone").removeClass("bpv-input-warning");$(".er_sign_up_email").addClass("hide");$(".er_sign_up_phone").addClass("hide");var b=$("#sign_up_email").val();var a=$("#sign_up_phone").val();if(IsEmail(b)&&IsPhone(a)){$("#"+d+"_hd").button("loading");$.ajax({url:"/sign-up-request/",type:"POST",data:{email:b,phone:a},success:function(e){if(e==1||e==2){$("#"+d+"_hd").button("reset");$("#"+d+"_waiting").addClass("hide");$(".er_sign_up_email").addClass("hide");$(".er_sign_up_phone").addClass("hide");$("#"+d+"_success").removeClass("hide");$("#"+d+"_form").addClass("hide");setTimeout(function(){$("#"+d).popover("hide")},10000)}else{if(e==3){$("#"+d+"_hd").button("reset");$("#sign_up_email").addClass("bpv-input-warning");$(".er_sign_up_email").removeClass("hide");$(".er_sign_up_email").html("Email đã được sử dụng , hãy chọn email khác")}else{if(e==4){$("#"+d+"_hd").button("reset");$("#sign_up_email").addClass("bpv-input-warning");$(".er_sign_up_email").removeClass("hide");$(".er_sign_up_email").html("Bạn cần nhập đúng thông tin <b>[Email]</b> ")}else{$("#"+d+"_hd").button("reset")}}}},error:function(g,f,e){$("#"+d+"_hd").button("reset")}})}else{if(!IsEmail(b)&&IsPhone(a)){$("#sign_up_email").focus();$("#sign_up_email").addClass("bpv-input-warning");$(".er_sign_up_email").removeClass("hide");$(".er_sign_up_email").html("Bạn cần nhập đúng thông tin <b>[Email]</b> ")}else{if(IsEmail(b)&&!IsPhone(a)){$("#sign_up_phone").focus();$("#sign_up_phone").addClass("bpv-input-warning");$(".er_sign_up_phone").removeClass("hide")}else{$("#sign_up_phone").focus();$("#sign_up_phone").addClass("bpv-input-warning");$(".er_sign_up_phone").removeClass("hide");$("#sign_up_email").focus();$("#sign_up_email").addClass("bpv-input-warning");$(".er_sign_up_email").removeClass("hide")}}}}function send_sign_in_request(c){var d=$(c).attr("data-id");$("#"+d+"_success").addClass("hide");var b=$("#sign_in_email").val();var a=$("#sign_in_password").val();if(IsEmail(b)&&(a!="")){$("#"+d+"_hd").button("loading");$.ajax({url:"/sign-in-request/",type:"POST",data:{email:b,password:a},success:function(e){if(e==1){$("#"+d).popover("hide");$("#btn_sign_in").addClass("hide");$("#btn_sign_up").addClass("hide");$("#sign_in").show();$("#sign_out").show();$("#sign_in").html("Chào : "+b);$("#sign_out").html("Thoát");window.location=window.location}else{$("#"+d+"_hd").button("reset");$("#"+d+"_waiting").addClass("hide");$(".er_sign_in").removeClass("hide")}},error:function(g,f,e){$("#"+d+"_hd").button("reset")}})}else{if(!IsEmail(b)){$("#sign_in_email").addClass("bpv-input-warning");$(".er_sign_in_email").removeClass("hide")}else{$(".er_sign_in").removeClass("hide")}}}function sign_out_request(){$.ajax({url:"/sign-out-request/",type:"POST",success:function(a){if(a!=""){window.location=window.location}else{}},error:function(c,b,a){}})}function IsPhone(b){var c=/^[0-9-+]+$/;if(c.test(b)){return true}else{return false}}function IsEmail(a){var b=/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;return b.test(a)}function get_current_search(a){$(function(){$.ajax({url:"/get-current-search/"+a+"/",type:"GET",dataType:"JSON",data:{},success:function(d){if(a==1){var c=$("#is_update_des").length==0||$("#is_update_des").val()==1;if(c){$("#destination").attr(d.destination);$("#oid").val(d.oid)}if(!d.is_default){$("#startdate").val(d.startdate);$("#enddate").val(d.enddate)}else{$("#startdate").val("");$("#enddate").val("")}$("#night option[value='"+d.night+"']").attr("selected","selected");get_check_out_date("#startdate","#night","#enddate","#show_search_end_date")}if(a==2){$("#flight_from option[value='"+d.From+"']").attr("selected","selected");var b=$("#is_update_fly_to").length==0||$("#is_update_fly_to").val()==1;if(b){$("#flight_to option[value='"+d.To+"']").attr("selected","selected")}$("#flight_departure_date").val(d.Depart);$("#flight_returning_date").val(d.Return);if(d.Return!=""){$("#delete_return").show()}else{$("#delete_return").hide()}$("#flight_dialog_departure_date").val(d.Depart);$("#flight_dialog_returning_date").val(d.Return);if(d.adt!=""){$("#adt option[value='"+d.adt+"']").attr("selected","selected");$("#dialog_adt option[value='"+d.adt+"']").attr("selected","selected")}if(d.chd!=""){$("#chd option[value='"+d.chd+"']").attr("selected","selected");$("#dialog_chd option[value='"+d.chd+"']").attr("selected","selected")}if(d.inf!=""){$("#inf option[value='"+d.inf+"']").attr("selected","selected");$("#dialog_inf option[value='"+d.inf+"']").attr("selected","selected")}}if(a==3){$("#destination").val(d.destination);$("#oid").val(d.oid);$("#duration option[value='"+d.duration+"']").attr("selected","selected");if(!d.is_default){$("#startdate").val(d.startdate);$("#enddate").val(d.enddate)}else{$("#startdate").val("");$("#enddate").val("");$("#duration option[value='']").attr("selected","selected")}get_end_date("#startdate","#duration","#enddate","#show_search_end_date")}},error:function(d,c,b){}})})}function get_hot_line(a){$.ajax({url:"/get-hot-line/"+a+"/",type:"GET",dataType:"JSON",success:function(e){if(e!=""){var d=e.number;var c=e.name;var b=d+" <small>("+c+")</small>";$("#hd_hotline").html(b);$("#ft_hotline").html(b);if(e.is_working_time!=1){$("#hd_phone").hide();$("#ft_phone").hide();$("#sd_hotline_tel_link").hide();if(e.sd_number!=""){var b=e.sd_number+" <small>("+e.sd_name+")</small>";$("#hd_phone").html(b);$("#ft_phone").html(b);$("#sd_hotline_tel_link").attr("href","tel:"+e.sd_number_formated);$("#hd_phone").show();$("#ft_phone").show();$("#sd_hotline_tel_link").show()}}if($("#hd_hotline_tel_link").length>0){$("#hd_hotline_tel_link").attr("href","tel:"+e.number_formated)}if($("#hd_hotline_header").length>0){$("#hd_hotline_header").attr("href","tel:"+e.number_formated)}if(e.h_hotline_nr!=""){$(".h-hotline-nr").attr("href","tel:"+e.h_hotline_nr_formated);$(".h-hotline-nr").text(e.h_hotline_nr+" ("+e.h_hotline_name+")")}if(e.f_hotline_nr!=""){$(".f-hotline-nr").attr("href","tel:"+e.f_hotline_nr_formated);$(".f-hotline-nr").text(e.f_hotline_nr+" ("+e.f_hotline_name+")")}if(e.is_mobile==1){$("#link_to_mobile").show()}}},error:function(d,c,b){}})}function get_hotline_support_popup(a){$.ajax({url:"/get-hotline-popup/",type:"GET",success:function(b){if(b!=""){$(a).html(b)}},error:function(d,c,b){}})}function get_quick_contact_popup(a){$.ajax({url:"/get-contact-popup/",type:"GET",success:function(b){if(b!=""){$(a).html(b)}},error:function(d,c,b){}})}function get_sign_up_popup(a){$.ajax({url:"/get-sign-up-popup/",type:"GET",success:function(b){if(b!=""){$(a).html(b)}},error:function(d,c,b){}})}function get_sign_in_popup(a){$.ajax({url:"/get-sign-in-popup/",type:"GET",success:function(b){if(b!=""){$(a).html(b)}},error:function(d,c,b){}})}jQuery.fn.center=function(){this.css("position","absolute");this.css("top",Math.max(0,(($(window).height()-$(this).outerHeight())/2)+$(window).scrollTop())+"px");this.css("left",Math.max(0,(($(window).width()-$(this).outerWidth())/2)+$(window).scrollLeft())+"px");return this};function load_reviews(a,b){var d='<div class="bpv-update-wrapper">';d+='<div class="bpv-search-updating center-block" ><div class="ms1">Đang tải dữ liệu</div>';d+='<div class="ms2"><img style="margin-right:15px;" src="/media/icon/loading.gif"><span>Xin đợi trong giây lát...</span></div></div>';var c=$(d).appendTo("body");$(c).center();$.ajax({url:b,type:"GET",success:function(e){$(c).remove();$(a).html(e)},error:function(g,f,e){$(c).remove()}})}function init_review_tab(a,b){if(b==true&&$(a).length){var c=$(a).attr("data-url");$.ajax({url:c,type:"GET",success:function(e){$(a).html(e)},error:function(g,f,e){$(div).remove()}})}else{$(a+" a").click(function(i){i.preventDefault();var h=$(this).attr("data-url");var g=this.hash;var f=$(this);if(g=="#tab_reviews"){load_reviews(g,h)}});var d=$("#tab").val();if(d=="tab_reviews"){d="#"+d;$(document).scrollTop($(a).offset().top);$(a+' a[href="'+d+'"]').tab("show");var c=$('a[href="'+d+'"]').attr("data-url");load_reviews(d,c)}}}function open_review(a){$(document).scrollTop($(a).offset().top);var c="#tab_reviews";$(a+' a[href="'+c+'"]').tab("show");if(c=="#tab_reviews"){var b=$('a[href="#tab_reviews"]').attr("data-url");load_reviews(c,b)}}jQuery.fn.bpvToggle=function(a){$(this).click(function(d){d.preventDefault();var c=$(this).attr("data-target");if($(c).length==0){return false}if(typeof a=="function"){a.call(this,{id:c})}var b=$(".bpv-toggle-icon",$(this));$(c).not(":animated").slideToggle("slow","swing",function(){if($(b).hasClass("icon-arrow-right-white")){$(b).toggleClass("icon-arrow-right-white-up")}if($(b).hasClass("icon-chevron-down")){$(b).toggleClass("icon-chevron-up")}if($(b).hasClass("icon-arrow-right-sm")){$(b).toggleClass("icon-arrow-right-sm-down")}})})};function get_marketing_popup(){$.ajax({url:"/get-marketing-popup/",type:"POST",cache:false,success:function(a){if(a!=""){$("body").append(a);$(".popup-wrap").click(function(){$(".popup-bg").remove();$(".popup-wrap").remove()});$(".popup-close").click(function(){$(".popup-bg").remove();$(".popup-wrap").remove()})}},error:function(c,b,a){}})}function get_marketing_box(){$.ajax({url:"/get-marketing-popup/",type:"POST",cache:false,data:{cfg:"marketing-more-people-more-save"},success:function(a){if(a!=""){$("body").append(a);$(".mk-box-close").click(function(){$(".marketing-box").remove()})}},error:function(c,b,a){}})}function show_link_data_overview(b,a){if($("#data_overview").length>0){$("#data_overview").modal();$("#data_overview_loading").show();$("#data_overview_content").hide();$.ajax({url:"/show-data-overview/",type:"POST",cache:false,data:{id:b,data_type:a},success:function(c){$("#data_overview_loading").hide();$("#data_overview_content").html(c);$("#data_overview_content").show()},error:function(e,d,c){$("#data_overview_content").html("<center>Lỗi kết nối dữ liệu!</center>");$("#data_overview_content").show()}})}}function set_up_tour_calendar(b){if(typeof b!=="undefined"&&b){b=true}else{b=false}var a=new Date();a=dateFormat(a);if($("#tour_departure_date").length>0){set_up_calendar("#tour_departure_date",null,b)}var c="#checkin_date";if($("#departure_id").length>0){$("#departure_id > option").each(function(){c="#checkin_date_"+$(this).val();if($(c).length>0){set_up_calendar(c,null,b);$(c).change(function(){c="#"+$(this).attr("id");get_check_out_date(c,"#stay_night","#checkout_date","#checkout_date_display")});get_check_out_date(c,"#stay_night","#checkout_date","#checkout_date_display")}})}else{if($(c).length>0){set_up_calendar(c,null,b);$(c).change(function(){get_check_out_date(c,"#stay_night","#checkout_date","#checkout_date_display")});get_check_out_date(c,"#stay_night","#checkout_date","#checkout_date_display")}}if($("#tour_start_date").length>0){set_up_calendar("#tour_start_date",null,b)}}function set_up_tour_autocomplete(b){if(typeof b!=="undefined"&&b){b=true}else{b=false}var a=new Bloodhound({datumTokenizer:function(e){return Bloodhound.tokenizers.whitespace(e.name)},queryTokenizer:Bloodhound.tokenizers.whitespace,remote:{url:"/suggest_tour_destinations/?query=%QUERY"}});a.initialize();var c="#tour_destination";$(c).typeahead({minLength:2,highlight:true,hint:false},{displayKey:"name",source:a.ttAdapter(),templates:{header:'<span class="lb-header">Quốc Gia/Thành Phố/Điểm Du Lịch</span>'}}).on("typeahead:selected",function(e,d){$("#tour_destination_input").val(d.url_title);$("#des_id").val(d.id);$(c).data("selected_value",$(c).val());if(!b){add_clear_search(c)}$(c).popover("hide")})}function validate_tour_search(){var a="#tour_destination";if($.trim($(a).val())==""){alert("Xin vui lòng nhập Quốc Gia/Thành Phố/Điểm Du Lịch");$(a).focus();$(a).addClass("bpv-input-warning");return false}return true}function init_tour_search(b,a){if(typeof a!=="undefined"&&a){a=true}else{a=false}if(b==undefined){b=false}if(b){get_current_search(4)}var c="#tour_destination";init_tour_date("#tour_departure_date","",a);if($(c).parent().find(".search-choice-close").length==0&&$(c).val()!=""&&!a){add_clear_search(c)}$(c).blur(function(){if($.trim($(c).val())!=""&&!a){add_clear_search(c)}});$("#dep_id").change(function(){if($("#dep_id").val()!=""){$("#departure").val($("#dep_id option:selected").text())}else{$("#departure").val("")}});$(c).on("input",function(){if($.trim($(c).val())!=$(c).data("selected_value")){$("#tour_destination_input").val("");$("#des_id").val("");$(".search-choice-close").remove()}$(c).popover("hide")});$(c).popover({html:true,trigger:"click",template:'<div class="popover suggestion-des tour-des-suggestion"><div class="arrow"></div><div class="popover-inner"><div class="popover-content"><p></p></div></div></div>',content:$("#tour_des_suggestion").html(),placement:"right"}).on("shown.bs.popover",function(d){$(".sg-des").click(function(){$(c).val($(this).attr("data-name"));$(".typeahead").typeahead("val",$(this).attr("data-name"));$("#tour_destination_input").val($(this).attr("data-url-title"));$("#des_id").val($(this).attr("data-id"));$(c).data("selected_value",$(c).val());add_clear_search(c);$(c).popover("hide");$(".typeahead").typeahead("close")});$(".group-name").bpvToggle()})}function init_tour_date(e,a,c){var b=new Date();if(a!=""){$(e).val(a)}var d="#btn_"+e.replace("#","");$(d).click(function(){$(e).focus()})}function get_hotline_box(a,b){$.ajax({url:"/get-hotline-box/",type:"POST",cache:false,data:{display_on:a,on_sidebar:b},success:function(c){if(c!=""){$("#hotline_support_box").html(c)}},error:function(e,d,c){$("#hotline_support_box").html("")}})};