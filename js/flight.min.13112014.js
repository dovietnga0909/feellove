function show_hide_contact(t){var e=$(t).attr("show"),a=$(t).text();"hide"==e?($(t).attr("show","show"),$(".bpv-contact-container").show(),a=a.replace("[+]","[-]")):($(t).attr("show","hide"),$(".bpv-contact-container").hide(),a=a.replace("[-]","[+]")),$(t).text(a)}function show_updating(){$("html, body").animate({scrollTop:0},"fast"),$(".bpv-update-wrapper").show(),setTimeout(function(){$(".bpv-update-wrapper").hide()},500)}function change_baggage(t){var e=0,a=0;$(".baggage-fees").each(function(){var t=$(this).val();""==t&&(t=0),t=parseInt(t);var i=$(this).find("option:selected").attr("fee");i=parseInt(i),e+=t,a+=i}),a>0?($("#flight_baggage_fee").show(),$("#total_kg").text(e),$("#flight_baggage_fee .col-2").html(bpv_format_currency(a,t))):$("#flight_baggage_fee").hide();var i=parseInt($("#flight_total_price").attr("ticket-price"));$("#flight_total_price").html(bpv_format_currency(i+a,t))}function get_flight_data(t,e,a,i){var r='<div class="alert alert-warning alert-dismissable"><button aria-hidden="true" data-dismiss="alert" class="close" type="button">&times;</button><span class="glyphicon glyphicon-warning-sign"></span>&nbsp;<strong>Lỗi kết nối với hãng bay. Xin vui lòng tìm kiếm lại!</strong></div>';if(void 0==a&&(a=0),void 0==i&&(i=""),$("#flight_loading_depart").hide(),$("#flight_loading_return").hide(),$("#flight_loading_change_day").hide(),0==a?($("#flight_data_content").html(""),"depart"==t?$("#flight_loading_depart").show():$("#flight_loading_return").show()):($("#flight_search_result_area").html(""),$("#flight_loading_change_day").show()),disable_filters(),"return"==t&&0!=a){var n=$("#flight_departure_id").val(),l=$("#flight_detail_"+n).attr("loaded");"0"==l&&$("#show_"+n).hide()}"return"==t&&$("#change_departure_flights").hide(),$.ajax({url:"/get-flight-data/",type:"POST",cache:!1,data:{flight_type:t,sid:e,day_index:a,departure_flight:i},success:function(e){$("#flight_loading_depart").hide(),$("#flight_loading_return").hide(),$("#flight_loading_change_day").hide(),$("#flight_data_content").html(e),enable_filters(),"return"==t&&$("#change_departure_flights").show()},error:function(){$("#flight_data_content").html(r),"return"==t&&$("#change_departure_flights").show()}})}function disable_filters(){$(".filter-airlines").attr("disabled","disabled"),$(".filter-times").attr("disabled","disabled")}function enable_filters(){var t=new Array;$("#rows_content .bpv-list-item").each(function(){var e=$(this).attr("time");t.push(e)}),t.length>0&&($(".filter-times").removeAttr("disabled"),$(".filter-times").attr("checked",!1),$(".filter-times").each(function(){var e=$(this).val();-1==t.indexOf(e)&&$(this).parent().parent().hide()}))}function create_airline_filters(t,e){$("#filter_airlines").html("");for(var a="",i=0;i<t.length;i++)a+='<div class="checkbox margin-bottom-20">',a+="<label>",a+='<input onclick="filter_flights()" class="filter-airlines" type="checkbox"',""!=e&&e==t[i].code&&(a+=' checked="checked" '),a=a+' value="'+t[i].code+'">',a=a+'<img src="http://flightbooking.bestpricevn.com/Images/Airlines/'+t[i].code+'.gif">&nbsp;',a+=t[i].name,a+="</label>",a+="</div>";$("#filter_airlines").html(a),""!=e&&filter_flights()}function filter_flights(){$(".bpv-s-content").hide(),show_updating();var t=new Array,e=new Array;$(".filter-airlines").each(function(){if($(this).is(":checked")){var e=$(this).val();t.push(e)}}),$(".filter-times").each(function(){if($(this).is(":checked")){var t=$(this).val();e.push(t)}}),show_hide_flight_rows(t,e)}function show_hide_flight_rows(t,e){$("#rows_content .bpv-list-item").each(function(){var a=$(this).attr("airline"),i=$(this).attr("time");is_shown(a,t)&&is_shown(i,e)?$(this).show("slow"):$(this).hide("slow")})}function is_shown(t,e){if(0==e.length)return!0;if(-1!=e.indexOf(t))return!0;for(var a=t.split(","),i=0;i<a.length;i++)if(-1!=e.indexOf(a[i]))return!0;return!1}function sort_flight_by(t){$(".bpv-s-content").hide(),show_updating();var e=new Array;$("#rows_content .bpv-list-item").each(function(){var t=$(this);e.push(t)}),$.each(["price","airline","departure"],function(e,a){$("#sort_by_"+a).removeClass("active"),$("#sort_by_"+a+" img").hide(),$("#sort_by_"+a+" span").hide(),a==t&&($("#sort_by_"+a).addClass("active"),$("#sort_by_"+a+" img").show(),$("#sort_by_"+a+" span").show())});for(var a=e.length-1;a>=0;a--)for(var i=1;a>=i;i++){var r=0,n=0;if("price"==t?(r=$(e[i-1]).attr("price"),n=$(e[i]).attr("price"),r=parseInt(r),n=parseInt(n)):"airline"==t?(r=$(e[i-1]).attr("code"),n=$(e[i]).attr("code")):"departure"==t&&(r=$(e[i-1]).attr("timefrom"),n=$(e[i]).attr("timefrom")),r>n){var l=e[i-1];e[i-1]=e[i],e[i]=l}else if(r==n&&(r=$(e[i-1]).attr("code"),n=$(e[i]).attr("code"),r>n)){var l=e[i-1];e[i-1]=e[i],e[i]=l}}for(var s="",a=0;a<e.length;a++){var _=$(e[a]).clone();$(_).wrap("<div>"),s+=$(_).parent().html()}$("#rows_content").html(s)}function show_flight_detail(t,e,a,i,r){var n=$("#flight_detail_"+e).attr("show"),l=$("#show_"+e).text();if("hide"==n){$("#flight_detail_"+e).attr("show","show"),l=l.replace("[ + ]","[ - ]"),$("#show_"+e).text(l),$("#flight_detail_"+e).show();var s=$("#flight_detail_"+e).attr("loaded");"0"==s&&(void 0!=a&&void 0!=i&&void 0!=r?get_flight_detail(t,e,a,i,r):get_flight_detail(t,e)),$("#flight_row_"+e).addClass("bpv-item-selected")}else $("#flight_detail_"+e).attr("show","hide"),l=l.replace("[ - ]","[ + ]"),$("#show_"+e).text(l),$("#flight_detail_"+e).hide(),$("#flight_row_"+e).removeClass("bpv-item-selected")}function get_flight_detail(t,e,a,i,r){var n='<div class="bpv-search-waiting"><div class="ms1">Đang tải dữ liệu chuyến bay</div><div class="ms2"><img style="margin-right:15px;" alt="" src="/media/icon/loading.gif"><span>Xin đợi trong giây lát...</span></div></div>',l='<div class="alert alert-warning alert-dismissable"><button aria-hidden="true" data-dismiss="alert" class="close" type="button">&times;</button><span class="glyphicon glyphicon-warning-sign"></span>&nbsp;<strong>Lỗi kết nối với hãng bay. Xin vui lòng tìm kiếm lại!</strong></div>';$("#flight_detail_"+e).html(n),$.ajax(void 0!=a&&void 0!=i&&void 0!=r?{url:"/get-flight-detail/",type:"POST",cache:!1,data:{sid:t,flight_id:e,flight_class:a,flight_stop:i,flight_type:r},success:function(t){""!=t?($("#flight_detail_"+e).html(t),$("#flight_detail_"+e).attr("loaded","1")):$("#flight_detail_"+e).html(l)},error:function(){$("#flight_detail_"+e).html(l)}}:{url:"/get-flight-detail-inter/",type:"POST",cache:!1,data:{sid:t,flight_id:e},success:function(t){""!=t?($("#flight_detail_"+e).html(t),$("#flight_detail_"+e).attr("loaded","1")):$("#flight_detail_"+e).html(l)},error:function(){$("#flight_detail_"+e).html(l)}})}function get_selected_flight_info(t){var e=t,a=$("#flight_row_"+t).attr("airline"),i=$("#flight_row_"+t).attr("code"),r=$("#flight_row_"+t).attr("timefrom"),n=$("#flight_row_"+t).attr("timeto"),l=$("#flight_row_"+t).attr("flightclass"),s=$("#flight_row_"+t).attr("flightstop"),_=$("#flight_row_"+t).attr("flightrclass");return e=e+";"+a+";"+i+";"+s+";"+r+";"+n+";"+l+";"+_}function show_fare_rules(t){txt_id="txt_"+t,t="fare_rules_"+t;var e=$("#"+t).attr("show");"hide"==e?($("#"+t).show(),$("#"+t).attr("show","show"),$("#"+txt_id).html("[ - ] Xem điều kiện vé")):($("#"+t).hide(),$("#"+t).attr("show","hide"),$("#"+txt_id).html("[ + ] Xem điều kiện vé"))}function validate_passengers(t){var e=!0,a=".required",i=".non-required",r=".pas-name";return $(a).removeClass("bpv-input-warning"),$(i).removeClass("bpv-input-warning"),void 0!=t&&(a="#"+t+" "+a,i="#"+t+" "+a),$(a).each(function(){var t=$(this).val();(""==$.trim(t)||0==/^[a-zA-Z0-9- ]*$/.test(t))&&(e=!1,$(this).addClass("bpv-input-warning"))}),$(i).each(function(){var t=$(this).val();0==/^[a-zA-Z0-9- ]*$/.test(t)&&(e=!1,$(this).addClass("bpv-input-warning"))}),$(r).each(function(){var t=$(this).val();t.indexOf(" ")<0&&(e=!1,$(this).addClass("bpv-input-warning"))}),$(a).change(function(){$(this).removeClass("bpv-input-warning")}),$(i).change(function(){$(this).removeClass("bpv-input-warning")}),e||$("#passenger_note").addClass("bpv-color-warning"),e}function validate_chd_inf_birthday(t,e,a){$(".age-warning").hide();var i=!0,r=a.split("/"),n=parseInt(r[0]),l=parseInt(r[1]),s=parseInt(r[2]),_=new Date(s-2,l,n,0,0,0,0),d=new Date(s-12,l,n,0,0,0,0),h=new Date(s,l,n,0,0,0,0);if(t>0)for(var o=1;t>=o;o++){var g=$("select[name=children_day_"+o+"]").val(),c=$("select[name=children_month_"+o+"]").val(),f=$("select[name=children_year_"+o+"]").val();g=parseInt(g),c=parseInt(c),f=parseInt(f);var p=new Date(f,c,g,0,0,0,0);(d>p||p>_)&&($("#chd_age_warning_"+o).show(),$("select[name=children_day_"+o+"]").addClass("bpv-input-warning"),$("select[name=children_month_"+o+"]").addClass("bpv-input-warning"),$("select[name=children_year_"+o+"]").addClass("bpv-input-warning"),i=!1)}if(e>0)for(var o=1;e>=o;o++){var u=$("select[name=infants_day_"+o+"]").val(),v=$("select[name=infants_month_"+o+"]").val(),m=$("select[name=infants_year_"+o+"]").val();u=parseInt(u),v=parseInt(v),m=parseInt(m);var w=new Date(m,v,u,0,0,0,0);(_>=w||w>=h)&&($("#inf_age_warning_"+o).show(),$("select[name=infants_day_"+o+"]").addClass("bpv-input-warning"),$("select[name=infants_month_"+o+"]").addClass("bpv-input-warning"),$("select[name=infants_year_"+o+"]").addClass("bpv-input-warning"),i=!1)}return i}function select_destination_flight(t,e,a,i,r,n){$("#flightModal").modal("show");var l=$("#sl_airline_img_"+e+"_"+a).attr("src");$("#dg_airline_img").attr("src",l),$("#dg_airline_name").html($("#sl_airline_name_"+a).html()),$("#dg_airline_code").val(i),$("#dg_txt_from").html($("#sl_from_des_"+e).html()),$("#dg_txt_to").html($("#sl_to_des_"+e).html());var s=$(t).attr("data-from"),_=$(t).attr("data-to");s=s+" ("+r+")",_=_+" ("+n+")",$("#dg_from").val(s),$("#dg_to").val(_)}function set_up_flight_dialog_calendar(){set_up_calendar("#flight_dialog_departure_date",function(t){$("#flight_dialog_departure_date").removeClass("bpv-input-warning");var e=$(this).datepicker("getDate"),a=$("#flight_dialog_returning_date").datepicker("getDate");null!=a&&e>=a&&($("#flight_dialog_returning_date").datepicker("setDate",t),setTimeout(function(){$("#flight_dialog_returning_date").datepicker("show")},100))}),set_up_calendar("#flight_dialog_returning_date",function(t){$("#flight_dialog_returning_date").removeClass("bpv-input-warning");var e=$("#flight_dialog_departure_date").datepicker("getDate"),a=$(this).datepicker("getDate");null!=e&&e>=a&&($("#flight_dialog_departure_date").datepicker("setDate",t),setTimeout(function(){$("#flight_dialog_departure_date").datepicker("show")},100))})}function init_flight_search_dialog(){$("#btn_flight_dialog_departure_date").click(function(){$("#flight_dialog_departure_date").focus()}),$("#btn_flight_dialog_returning_date").click(function(){$("#flight_dialog_returning_date").focus()})}function update_flight_total_payment(t){var e=$("#flight_total_price").attr("total-price");e=void 0==e||""==e?0:parseInt(e);var a=$("#applied_code_discount").attr("rate");a=void 0==a||""==a?0:parseInt(a);var i=e-a;return $("#flight_total_price").html(bpv_format_currency(i,t)),i}function update_flight_baggage_pas_name(){$(".pas-name").each(function(){var t=$(this).attr("index"),e=$(this).val();if(""!=$.trim(e))$(".bag-pas-"+t).text(e);else{var a=$(".bag-pas-"+t).attr("txtval");$(".bag-pas-"+t).text(a)}})}function change_flight_date(t,e,a,i,r){"depart"==t?($(".selected-departure-date").text(i+", "+r),$("#flight_departure_date").val(r)):($(".selected-return-date").text(i+", "+r),$("#flight_returning_date").val(r)),$(".cal-selected").removeClass("cal-selected"),$(".cal-arrow-down").remove(),$(".cal-item").each(function(){var t=$(this).attr("dayindex");t==a&&($(this).addClass("cal-selected"),$(this).parent().append('<div class="cal-arrow-down center-block"></div>')),$(this).removeClass("cal-active"),$(this).prop("onclick",null)});var n="";"return"==t&&(n=$("#flight_departure").val(),n=n.split(";"),n=n[2]),get_flight_data(t,e,a,n)}function update_selected_depature_flight(t,e){var a=t.split(";"),i=$("#flight_departure_id").val();$("#show_"+i).show(),$("#flight_detail_"+i).attr("id","flight_detail_"+a[0]),$("#show_"+i).attr("id","show_"+a[0]);var r="javascript:show_flight_detail('"+e+"',"+a[0]+",'"+a[6]+"','"+a[3]+"','depart')";$("#show_"+a[0]).attr("href",r),$("#show_"+a[0]).show(),$("#flight_departure").val(t)}