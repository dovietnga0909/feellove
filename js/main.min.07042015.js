function check_date(e){var t=/^\d{2}\/\d{2}\/\d{4}$/,a=!1;if(!t.test(e))return!1;var n=e.split("/")[0],i=e.split("/")[1],o=e.split("/")[2],r=new Date(o,i-1,n);return a=r.getMonth()+1!=i||r.getDate()!=n||r.getFullYear()!=o?!1:!0,0==a&&input.select(),a}function init_flight_search(){$("#btn_flight_departure_date").click(function(){$("#flight_departure_date").focus()}),$("#btn_flight_returning_date").click(function(){$("#flight_returning_date").focus()})}function set_up_flight_calendar(e){e="undefined"!=typeof e&&e?!0:!1,set_up_calendar("#flight_departure_date",function(t){$("#flight_departure_date").removeClass("bpv-input-warning");var a=$(this).datepicker("getDate"),n=$("#flight_returning_date").datepicker("getDate");e||null!=n&&a>=n&&($("#flight_returning_date").datepicker("setDate",t),setTimeout(function(){$("#flight_returning_date").datepicker("show")},100))},e),set_up_calendar("#flight_returning_date",function(t){$("#flight_returning_date").removeClass("bpv-input-warning"),$("#delete_return").show(),$("#flight_type").length>0&&$("input[name=Type][value=roundway]").prop("checked",!0);var a=$("#flight_departure_date").datepicker("getDate"),n=$(this).datepicker("getDate");e||null!=a&&a>=n&&($("#flight_departure_date").datepicker("setDate",t),setTimeout(function(){$("#flight_departure_date").datepicker("show")},100))},e)}function delete_flight_return(){$("#flight_returning_date").removeClass("bpv-input-warning"),$("#flight_returning_date").val(""),$("#delete_return").hide(),$("#flight_type").length>0&&$("input[name=Type][value=oneway]").prop("checked",!0)}function select_flight_type(){var e=$('input[name="Type"]:checked').val();"oneway"==e&&delete_flight_return()}function check_search_type(){var e=$('input[name="search_type"]:checked').val();0==e?($("#tab_search_hotel").show(),$("#tab_search_flight").hide(),$("#tab_search_tour").hide()):1==e?($("#tab_search_hotel").hide(),$("#tab_search_flight").show(),$("#tab_search_tour").hide()):($("#tab_search_hotel").hide(),$("#tab_search_flight").hide(),$("#tab_search_tour").show()),$("#search_label").text($("#txt_search_label_"+e).text())}function validate_flight_search(){var e=$("#flight_from"),t=$("#flight_to");if(""==$.trim(e.val()))return alert('Xin vui lòng nhập "Điểm Đi"'),$(e).focus(),$(e).addClass("bpv-input-warning"),!1;if(""==$.trim(t.val()))return alert('Xin vui lòng nhập "Điểm Đến"'),$(t).focus(),$(t).addClass("bpv-input-warning"),!1;var a=$("#flight_departure_date").val(),n=$("#flight_returning_date").val();if(""==$.trim(a))return alert('Xin vui lòng nhập "Ngày đi"'),$("#flight_departure_date").focus(),$("#flight_departure_date").addClass("bpv-input-warning"),!1;if(!check_date(a))return alert('"Ngày đi" phải theo định dạng '+FORMAT_DATE),$("#flight_departure_date").focus(),$("#flight_departure_date").addClass("bpv-input-warning"),!1;var i=new Date;if(i=dateFormat(i),get_JS_Date(a)<get_JS_Date(i))return alert('"Ngày đi" không được phép là ngày trong quá khứ!'),$("#flight_departure_date").focus(),$("#flight_departure_date").addClass("bpv-input-warning"),!1;if(""!=n&&!check_date(n))return alert('"Ngày về" phải theo định dạng '+FORMAT_DATE),$("#flight_returning_date").focus(),$("#flight_returning_date").addClass("bpv-input-warning"),!1;if(""!=n&&get_JS_Date(a)>get_JS_Date(n))return alert('Vui lòng nhập "Ngày về" lớn hơn hoặc bằng "Ngày đi"'),$("#flight_returning_date").focus(),$("#flight_returning_date").addClass("bpv-input-warning"),!1;if($("#flight_type").length>0){var o=$('input[name="Type"]:checked').val();if("roundway"==o&&""==$.trim(n))return alert('Bạn đang tìm kiếm chuyến bay khứ hồi. Xin vui lòng nhập "Ngày về"'),$("#flight_returning_date").focus(),$("#flight_returning_date").addClass("bpv-input-warning"),!1}return!0}function validate_flight_search_dialog(){var e=$("#flight_dialog_departure_date").val(),t=$("#flight_dialog_returning_date").val();if(""==$.trim(e))return alert('Xin vui lòng nhập "Ngày đi"'),$("#flight_dialog_departure_date").focus(),$("#flight_dialog_departure_date").addClass("bpv-input-warning"),!1;if(!check_date(e))return alert('"Ngày đi" phải theo định dạng '+FORMAT_DATE),$("#flight_dialog_departure_date").focus(),$("#flight_dialog_departure_date").addClass("bpv-input-warning"),!1;var a=new Date;return a=dateFormat(a),get_JS_Date(e)<get_JS_Date(a)?(alert('"Ngày đi" không được phép là ngày trong quá khứ!'),$("#flight_dialog_departure_date").focus(),$("#flight_dialog_departure_date").addClass("bpv-input-warning"),!1):""==t||check_date(t)?""!=t&&get_JS_Date(e)>get_JS_Date(t)?(alert('Vui lòng nhập "Ngày về" lớn hơn hoặc bằng "Ngày đi"'),$("#flight_dialog_returning_date").focus(),$("#flight_dialog_returning_date").addClass("bpv-input-warning"),!1):!0:(alert('"Ngày về" phải theo định dạng '+FORMAT_DATE),$("#flight_dialog_returning_date").focus(),$("#flight_dialog_returning_date").addClass("bpv-input-warning"),!1)}function init_hotel_date(e,t,a,n,i){var o=new Date;o=dateFormat(o),""!=i&&void 0!=i&&$(e).val(i),get_check_out_date(e,t,a,n),$(e).change(function(){get_check_out_date(e,t,a,n)}),$(t).change(function(){get_check_out_date(e,t,a,n)});var r="#btn_"+e.replace("#","");$(r).click(function(){$(e).focus()})}function init_hotel_search(e,t){t="undefined"!=typeof t&&t?!0:!1,void 0==e&&(e=!1),e&&get_current_search(1),init_hotel_date("#startdate","#night","#enddate","#show_search_end_date",""),0!=$("#destination").parent().find(".search-choice-close").length||""==$("#destination").val()||t||add_clear_search("#destination"),$("#destination").blur(function(){""==$.trim($("#destination").val())||t||add_clear_search("#destination")}),$("#destination").on("input",function(){$.trim($("#destination").val())!=$("#destination").data("selected_value")&&($("#hotel_destination_input").val(""),$("#oid").val(""),$(".search-choice-close").remove(),$("#destination").popover("hide"))}),check_search_type(),$("#destination").popover({html:!0,trigger:"click",template:'<div class="popover suggestion-des"><div class="arrow"></div><div class="popover-inner"><div class="popover-content"><p></p></div></div></div>',content:$("#suggestion-des").html(),placement:"right"}).on("shown.bs.popover",function(){$(".suggestion-des a").click(function(){$("#destination").val($(this).attr("data-name")),$(".typeahead").typeahead("val",$(this).attr("data-name")),$("#hotel_destination_input").val($(this).attr("data-url-title")),$("#oid").val("d-"+$(this).attr("data-id")),$("#destination").data("selected_value",$("#destination").val()),add_clear_search("#destination"),$("#destination").popover("hide"),$(".typeahead").typeahead("close")})})}function set_up_calendar(e,t,a){var n=2;"undefined"!=typeof a&&a?(a=!0,n=1):a=!1,void 0==t&&"function"!=typeof t&&(t=null),$(e).datepicker({numberOfMonths:n,closeText:"Đóng",currentText:"Hôm nay",showButtonPanel:a,minDate:0,monthNames:["Tháng 1","Tháng 2","Tháng 3","Tháng 4","Tháng 5","Tháng 6","Tháng 7","Tháng 8","Tháng 9","Tháng 10","Tháng 11","Tháng 12"],dayNames:["CN","T2","T3","T4","T5","T6","T7"],dayNamesMin:["CN","T2","T3","T4","T5","T6","T7"],dateFormat:FORMAT_DATE_CALENDAR,onSelect:t}),a&&$(e).on("focus",function(){$(this).trigger("blur")})}function set_up_hotel_calendar(e){e="undefined"!=typeof e&&e?!0:!1,$("#startdate").length>0&&set_up_calendar("#startdate",null,e),$("#checkin_date").length>0&&set_up_calendar("#checkin_date",null,e)}function set_up_hotel_autocomplete(e){e="undefined"!=typeof e&&e?!0:!1;var t=new Bloodhound({datumTokenizer:function(e){return Bloodhound.tokenizers.whitespace(e.name)},queryTokenizer:Bloodhound.tokenizers.whitespace,remote:{url:"/suggest_hotel_destinations/?query=%QUERY"}}),a=new Bloodhound({datumTokenizer:function(e){return Bloodhound.tokenizers.whitespace(e.name)},queryTokenizer:Bloodhound.tokenizers.whitespace,remote:{url:"/suggest_hotels/?query=%QUERY"}});t.initialize(),a.initialize(),$("#destination").typeahead({minLength:2,highlight:!0,hint:!1},{displayKey:"name",source:t.ttAdapter(),templates:{header:'<span class="lb-header">Tỉnh/Thành Phố/Địa danh</span>'}},{displayKey:"name",source:a.ttAdapter(),templates:{header:'<span class="lb-header">Khách Sạn</span>'}}).on("typeahead:selected",function(t,a){$("#hotel_destination_input").val(a.url_title),$("#oid").val(a.type+"-"+a.id),$("#destination").data("selected_value",$("#destination").val()),e||add_clear_search("#destination"),$("#destination").popover("hide")})}function add_clear_search(e){if(0==$(e).parent().find(".search-choice-close").length){var t=$('<span class="icon btn-search-close search-choice-close"></span>');$(e).parent().append(t),t.click(function(){clear_search(e)})}}function clear_search(e){$(e).val(""),$(e).focus(),$(e).parent().find(".typeahead").typeahead("val",""),$(e).parent().parent().find(".search-choice-close").remove(),"#destination"==e&&($("#oid").val(""),$("#hotel_destination_input").val("")),"#tour_destination"==e&&$("#des_id").val("")}function get_check_out_date(e,t,a,n){var i=$(e).val();if(check_date(i)){var o=get_JS_Date(i),r=$(t).val();o.setDate(o.getDate()+parseInt(r,10)),check_date(dateFormat(o))&&($(n).html(dateFormat(o)),$(a).val(dateFormat(o)),$("#enddate_lbl").length>0&&$("#enddate_lbl").show())}}function validate_hotel_search(){if(""==$.trim($("#destination").val()))return alert("Xin vui lòng nhập Tỉnh/Thành Phố/Điểm Du Lịch/Tên Khách Sạn"),$("#destination").focus(),$("#destination").addClass("bpv-input-warning"),!1;var e=$("#startdate").val();return""==$.trim(e)?($("#startdate").focus(),$("#startdate").addClass("bpv-input-warning"),alert('Xin vui lòng nhập thông tin "Ngày nhận phòng"'),!1):check_date(e)?!0:($("#startdate").focus(),$("#startdate").addClass("bpv-input-warning"),alert('"Ngày nhận phòng" phải theo định dạng '+FORMAT_DATE),!1)}function not_interested(e){$.ajax({url:"/remove_recent_item/",type:"POST",cache:!0,data:{item_id:e},success:function(){}}),$("#ritem-"+e).prev().length>0&&$("#ritem-"+e).prev().addClass("no-border"),$("#ritem-"+e).remove();var t=$("#box_recent_items .bpt-list-sm").length;1>t&&$("#box_recent_items").remove()}function bpv_format_currency(e,t){if(e=e.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1."),e.length>3){var a=e.substring(0,e.length-3),n=e.substring(e.length-3,e.length);e=a+"<small>"+n+" "+t+"</small>"}return e}function go_url(e){window.location=e}function go_check_rate_position(){$("html, body").animate({scrollTop:$(".bpv-check-rate-form").offset().top},"fast")}function go_position(e){$("html, body").animate({scrollTop:e},"fast")}function get_url_var(e,t){var a=new RegExp(e+"=([^&]*)","i").exec(t);return a&&unescape(a[1])||""}function show_more_photos(){var e=$("#show_more_photos").attr("show"),t=$("#show_more_photos").text();"hide"==e?($(".more-photos").show(),$("#show_more_photos").attr("show","show"),t=t.replace("[+]","[-]")):($(".more-photos").hide(),$("#show_more_photos").attr("show","hide"),t=t.replace("[+]","[-]")),$("#show_more_photos").text(t)}function show_more_rooms(){var e=$("#show_more_rooms").attr("show"),t=$("#show_more_rooms").text();"hide"==e?($(".more-rooms").show(),$("#show_more_rooms").attr("show","show"),t=t.replace("[+]","[-]")):($(".more-rooms").hide(),$("#show_more_rooms").attr("show","hide"),t=t.replace("[-]","[+]")),$("#show_more_rooms").text(t)}function show_more(e){var t=$(e).attr("show"),a=$(e).text();"hide"==t?($(".hidden-item").show(),$(e).attr("show","show"),a=a.replace("[+]","[-]")):($(".hidden-item").hide(),$(e).attr("show","hide"),a=a.replace("[+]","[-]")),$(e).text(a)}function change_search(){$(".bpv-search-overview").hide(),$(".bpv-search-left").show()}function is_valid_email(e){var t=/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;return t.test(e)?!0:!1}function validate_contact_form(){var e=!0;$(".bpv-contact .warning-message").hide(),$(".bpv-contact input").removeClass("bpv-input-warning"),$(".bpv-contact select").removeClass("bpv-input-warning"),""==$.trim($("#gender").val())&&($("#gender").addClass("bpv-input-warning"),$("#title_required").show(),e=!1),""==$.trim($("#name").val())&&($("#name").addClass("bpv-input-warning"),$("#name_required").show(),e=!1),""==$.trim($("#email").val())?($("#email").addClass("bpv-input-warning"),$("#email_required").show(),e=!1):is_valid_email($("#email").val())||($("#email").addClass("bpv-input-warning"),$("#email_valid").show(),e=!1);var t=$.trim($("#c_day").val()),a=$.trim($("#c_month").val()),n=$.trim($("#c_year").val()),i=""!=t||""!=a||""!=n;if(i&&((""==t||""==a||""==n)&&($("#birthday_valid").show(),e=!1),""==t&&$("#c_day").addClass("bpv-input-warning"),""==a&&$("#c_month").addClass("bpv-input-warning"),""==n&&$("#c_year").addClass("bpv-input-warning")),""==$.trim($("#phone").val())&&($("#phone").addClass("bpv-input-warning"),$("#phone_required").show(),e=!1),""==$.trim($("#phone_cf").val())?($("#phone_cf").addClass("bpv-input-warning"),$("#phone_cf_required").show(),e=!1):$("#phone_cf").val()!=$("#phone").val()&&($("#phone_cf").addClass("bpv-input-warning"),$("#phone_cf_valid").show(),e=!1),e){if($("#payment_method").length>0){var o=$("#payment_method").val();""==o&&(alert("Xin vui lòng lựa chọn hình thức thanh toán."),e=!1,go_position($(".bpv-payment-methods").offset().top))}e&&$("#submit_data_waiting").length>0&&$("#submit_data_waiting").modal()}else go_position($(".bpv-contact").offset().top);return e}function init_payment_detail(){$(".right-fixed").width($(".bpv-col-left").width());var e=$("#pro_code").val();""!=$.trim(e)?$("#pro_use").show():$("#pro_use").hide(),$("#pro_code").keyup(function(){var e=$("#pro_code").val();""!=$.trim(e)?($("#pro_use").show(),$("#pro_use_2").show()):($("#pro_use").hide(),$("#pro_use_2").hide()),$("#pro_code_2").val(e)}),$("#pro_code_2").keyup(function(){var e=$("#pro_code_2").val();""!=$.trim(e)?($("#pro_use").show(),$("#pro_use_2").show()):($("#pro_use").hide(),$("#pro_use_2").hide()),$("#pro_code").val(e)})}function use_pro_code(e){reset_pro_code_discount(e),$("#code_invalid").hide(),$("#code_ok").hide(),$("#code_invalid_2").hide(),$("#code_ok_2").hide();var t=$.trim($("#pro_code").val()),a=$("#pro_hotel").val(),n=$("#pro_cruise").val(),i=$("#pro_tour").val(),o=$("#pro_nr_passengers").val();0==/^[a-zA-Z0-9- ]*$/.test(t)||""==t?($("#code_invalid").show(),$("#code_invalid_2").show()):($("#pro_use").button("loading"),$("#pro_use_2").button("loading"),$.ajax({url:"/apply-promotion-code/",type:"POST",cache:!1,dataType:"json",data:{service_type:e,pro_code:t,hotel_id:a,cruise_id:n,tour_id:i,nr_passengers:o},success:function(a){$("#pro_use").button("reset"),$("#pro_use_2").button("reset"),""==a?($("#code_invalid").show(),$("#code_invalid_2").show()):update_booking_payment(a,t,e)},error:function(){$("#code_invalid").show(),$("#pro_use").button("reset"),$("#code_invalid_2").show(),$("#pro_use_2").button("reset")}}))}function update_booking_payment(e,t,a){var n=0;if(2==e.discount_type&&(n=e.get),3==e.discount_type){var i=e.get,o=$("#nr_ticket").val();o=void 0==o||""==o?0:parseInt(o),n=i*o}if(4==e.discount_type){var i=e.get,r=$("#nr_pax").val();r=void 0==r||""==r?0:parseInt(r),n=i*r}if(1==e.discount_type){var i=e.get,s=e.get_max,d=0;1==a&&(d=update_hotel_total_payment("đ")),2==a&&(d=update_flight_total_payment("đ")),3==a&&(d=update_cruise_total_payment("đ")),4==a&&(d=update_tour_total_payment("đ"));var n=d*i/100;n>s&&s>0&&(n=s),n=1e3*Math.round(n/1e3)}$("#applied_code_discount").attr("rate",n),$("#applied_code_discount").html("- "+bpv_format_currency(n,"đ")),$("#applied_code").text(t),n>0&&$("#p_applied_code").show();var _='<span class="glyphicon glyphicon-ok"></span>';return n>0&&(_=_+"&nbsp; Đã giảm giá <b>"+bpv_format_currency(n,"đ")+"</b>."),void 0!=e.discount_note&&""!=e.discount_note&&(_=_+"&nbsp; "+e.discount_note),$("#code_ok").html(_),$("#code_ok").show(),$("#code_ok_2").html(_),$("#code_ok_2").show(),$("#promotion_code_used").val(t),1==a&&update_hotel_total_payment("đ"),2==a&&update_flight_total_payment("đ"),3==a&&update_cruise_total_payment("đ"),4==a&&update_tour_total_payment("đ"),n}function reset_pro_code_discount(e){$("#applied_code_discount").attr("rate",0),$("#p_applied_code").hide(),$("#promotion_code_used").val(""),1==e&&update_hotel_total_payment("đ"),2==e&&update_flight_total_payment("đ"),3==e&&update_cruise_total_payment("đ"),4==e&&update_tour_total_payment("đ")}function send_contact_request(e){var t=$(e).attr("data-id"),a=["groupon_request","groupon_email","groupon_phone_number"],n=!0;$.each(a,function(e,t){var a=$("#"+t).val();""==a||"groupon_email"==t&&!IsEmail(a)||"groupon_phone_number"==t&&!IsPhone(a)?($("#"+t).focus(),$("#"+t).addClass("bpv-input-warning"),$(".er_"+t).removeClass("hide"),n=!1):($("#"+t).removeClass("bpv-input-warning"),$(".er_"+t).addClass("hide"))}),n&&($("#"+t+"_hd").button("loading"),$("#"+t+"_form").addClass("hide"),$("#"+t+"_waiting").removeClass("hide"),$.ajax({url:"/groupon_request/",type:"POST",data:{groupon_request:$("#groupon_request").val(),groupon_email:$("#groupon_email").val(),groupon_phone_number:$("#groupon_phone_number").val(),groupon_pop_type:$("#popup_type").val()},success:function(){$("#"+t+"_hd").button("reset"),$("#"+t+"_waiting").addClass("hide"),$("#"+t+"_success").removeClass("hide"),setTimeout(function(){$("#"+t).popover("hide")},1e4)},error:function(){$("#"+t+"_hd").button("reset"),alert("Có lỗi kết nối mạng, yêu cầu của quý khách không thể gửi đi, xin quý khách vui lòng gọi đến số 04 3978 1425 để gặp trực tiếp nhân viên của chúng tôi."),$("#"+t).popover("hide")}}))}function send_tour_contact_request(e){{var t=($(e).attr("id"),$("#tour_request_email").val()),a=$("#tour_request_phone").val();$("#adults").val(),$("#children").val(),$("#infants").val(),$("#tour_request_content").val()}return $("#tour_request_email").removeClass("bpv-input-warning"),$("#tour_request_phone").removeClass("bpv-input-warning"),$(".er_tour_request_email").addClass("hide"),$(".er_tour_request_phone").addClass("hide"),IsEmail(t)&&IsPhone(a)?!0:!IsEmail(t)&&IsPhone(a)?($("#tour_request_email").focus(),$("#tour_request_email").addClass("bpv-input-warning"),$(".er_tour_request_email").removeClass("hide"),$(".er_tour_request_email").html("Bạn cần nhập đúng thông tin <b>[Email]</b> "),!1):IsEmail(t)&&!IsPhone(a)?($("#tour_request_phone").focus(),$("#tour_request_phone").addClass("bpv-input-warning"),$(".er_tour_request_phone").removeClass("hide"),!1):($("#tour_request_email").focus(),$("#tour_request_email").addClass("bpv-input-warning"),$(".er_tour_request_email").removeClass("hide"),$("#tour_request_phone").focus(),$("#tour_request_phone").addClass("bpv-input-warning"),$(".er_tour_request_phone").removeClass("hide"),!1)}function send_news_letter_request(e){var t=($(e).attr("id"),$("#newsletter_to").val());IsEmail(t)?($("#newsletter").button("loading"),$("#newsletter").html("Đang xử lý"),$.ajax({url:"/news-letter-request/",type:"POST",data:{news_letter_to:t},success:function(e){1==e||2==e?($("#newsletter").button("reset"),$("#newsletter_to").attr("readonly","1"),$("#newsletter_to").removeClass("bpv-input-warning"),$("#newsletter_to").val(""),$("#newsletter").css("margin-top","27px"),$(".bpv-register").css("height","90px"),$("#newsletter_invalid").addClass("hide"),$("#newsletter_ok").removeClass("hide")):3==e&&($("#newsletter").button("reset"),$("#newsletter_to").focus(),$("#newsletter_to").addClass("bpv-input-warning"),$("#newsletter_invalid").removeClass("hide"),$("#newsletter").css("margin-top","27px"),$(".bpv-register").css("height","90px"))},error:function(){$("#newsletter").button("reset"),alert("Quý khách hãy nhấn lại đăng ký.")}})):($("#newsletter_to").focus(),$("#newsletter_to").addClass("bpv-input-warning"),$("#newsletter_invalid").removeClass("hide"),$("#newsletter").css("margin-top","27px"),$(".bpv-register").css("height","90px"))}function send_sign_up_request(e){var t=$(e).attr("data-id");$("#"+t+"_success").addClass("hide"),$("#sign_up_email").removeClass("bpv-input-warning"),$("#sign_up_phone").removeClass("bpv-input-warning"),$(".er_sign_up_email").addClass("hide"),$(".er_sign_up_phone").addClass("hide");var a=$("#sign_up_email").val(),n=$("#sign_up_phone").val();IsEmail(a)&&IsPhone(n)?($("#"+t+"_hd").button("loading"),$.ajax({url:"/sign-up-request/",type:"POST",data:{email:a,phone:n},success:function(e){1==e||2==e?($("#"+t+"_hd").button("reset"),$("#"+t+"_waiting").addClass("hide"),$(".er_sign_up_email").addClass("hide"),$(".er_sign_up_phone").addClass("hide"),$("#"+t+"_success").removeClass("hide"),$("#"+t+"_form").addClass("hide"),setTimeout(function(){$("#"+t).popover("hide")},1e4)):3==e?($("#"+t+"_hd").button("reset"),$("#sign_up_email").addClass("bpv-input-warning"),$(".er_sign_up_email").removeClass("hide"),$(".er_sign_up_email").html("Email đã được sử dụng , hãy chọn email khác")):4==e?($("#"+t+"_hd").button("reset"),$("#sign_up_email").addClass("bpv-input-warning"),$(".er_sign_up_email").removeClass("hide"),$(".er_sign_up_email").html("Bạn cần nhập đúng thông tin <b>[Email]</b> ")):$("#"+t+"_hd").button("reset")},error:function(){$("#"+t+"_hd").button("reset")}})):!IsEmail(a)&&IsPhone(n)?($("#sign_up_email").focus(),$("#sign_up_email").addClass("bpv-input-warning"),$(".er_sign_up_email").removeClass("hide"),$(".er_sign_up_email").html("Bạn cần nhập đúng thông tin <b>[Email]</b> ")):IsEmail(a)&&!IsPhone(n)?($("#sign_up_phone").focus(),$("#sign_up_phone").addClass("bpv-input-warning"),$(".er_sign_up_phone").removeClass("hide")):($("#sign_up_phone").focus(),$("#sign_up_phone").addClass("bpv-input-warning"),$(".er_sign_up_phone").removeClass("hide"),$("#sign_up_email").focus(),$("#sign_up_email").addClass("bpv-input-warning"),$(".er_sign_up_email").removeClass("hide"))}function send_sign_in_request(e){var t=$(e).attr("data-id");$("#"+t+"_success").addClass("hide");var a=$("#sign_in_email").val(),n=$("#sign_in_password").val();IsEmail(a)&&""!=n?($("#"+t+"_hd").button("loading"),$.ajax({url:"/sign-in-request/",type:"POST",data:{email:a,password:n},success:function(e){1==e?($("#"+t).popover("hide"),$("#btn_sign_in").addClass("hide"),$("#btn_sign_up").addClass("hide"),$("#sign_in").show(),$("#sign_out").show(),$("#sign_in").html("Chào : "+a),$("#sign_out").html("Thoát"),window.location=window.location):($("#"+t+"_hd").button("reset"),$("#"+t+"_waiting").addClass("hide"),$(".er_sign_in").removeClass("hide"))},error:function(){$("#"+t+"_hd").button("reset")}})):IsEmail(a)?$(".er_sign_in").removeClass("hide"):($("#sign_in_email").addClass("bpv-input-warning"),$(".er_sign_in_email").removeClass("hide"))}function sign_out_request(){$.ajax({url:"/sign-out-request/",type:"POST",success:function(e){""!=e&&(window.location=window.location)},error:function(){}})}function IsPhone(e){var t=/^[0-9-+]+$/;return t.test(e)?!0:!1}function IsEmail(e){var t=/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;return t.test(e)}function get_current_search(e){$(function(){$.ajax({url:"/get-current-search/"+e+"/",type:"GET",dataType:"JSON",data:{},success:function(t){if(1==e){var a=0==$("#is_update_des").length||1==$("#is_update_des").val();a&&($("#destination").attr(t.destination),$("#oid").val(t.oid)),t.is_default?($("#startdate").val(""),$("#enddate").val("")):($("#startdate").val(t.startdate),$("#enddate").val(t.enddate)),$("#night option[value='"+t.night+"']").attr("selected","selected"),get_check_out_date("#startdate","#night","#enddate","#show_search_end_date")}if(2==e){$("#flight_from option[value='"+t.From+"']").attr("selected","selected");var n=0==$("#is_update_fly_to").length||1==$("#is_update_fly_to").val();n&&$("#flight_to option[value='"+t.To+"']").attr("selected","selected"),$("#flight_departure_date").val(t.Depart),$("#flight_returning_date").val(t.Return),""!=t.Return?$("#delete_return").show():$("#delete_return").hide(),$("#flight_dialog_departure_date").val(t.Depart),$("#flight_dialog_returning_date").val(t.Return),""!=t.adt&&($("#adt option[value='"+t.adt+"']").attr("selected","selected"),$("#dialog_adt option[value='"+t.adt+"']").attr("selected","selected")),""!=t.chd&&($("#chd option[value='"+t.chd+"']").attr("selected","selected"),$("#dialog_chd option[value='"+t.chd+"']").attr("selected","selected")),""!=t.inf&&($("#inf option[value='"+t.inf+"']").attr("selected","selected"),$("#dialog_inf option[value='"+t.inf+"']").attr("selected","selected"))}3==e&&($("#destination").val(t.destination),$("#oid").val(t.oid),$("#duration option[value='"+t.duration+"']").attr("selected","selected"),t.is_default?($("#startdate").val(""),$("#enddate").val(""),$("#duration option[value='']").attr("selected","selected")):($("#startdate").val(t.startdate),$("#enddate").val(t.enddate)),get_end_date("#startdate","#duration","#enddate","#show_search_end_date"))},error:function(){}})})}function get_hot_line(e){$.ajax({url:"/get-hot-line/"+e+"/",type:"GET",dataType:"JSON",success:function(e){if(""!=e){var t=e.number,a=e.name,n=t+" <small>("+a+")</small>";$("#hd_hotline").html(n),$("#hd_hotline_tel_link").length>0&&$("#hd_hotline_tel_link").attr("href","tel:"+e.number_formated),$("#hd_hotline_header").length>0&&$("#hd_hotline_header").attr("href","tel:"+e.number_formated);var i=" / "+t;$("#footer_hotline").append(i),""!=e.h_hotline_nr&&($(".h-hotline-nr").attr("href","tel:"+e.h_hotline_nr_formated),$(".h-hotline-nr").text(e.h_hotline_nr+" ("+e.h_hotline_name+")")),""!=e.f_hotline_nr&&($(".f-hotline-nr").attr("href","tel:"+e.f_hotline_nr_formated),$(".f-hotline-nr").text(e.f_hotline_nr+" ("+e.f_hotline_name+")"))}},error:function(){}})}function get_hotline_support_popup(e){$.ajax({url:"/get-hotline-popup/",type:"GET",success:function(t){""!=t&&$(e).html(t)},error:function(){}})}function get_quick_contact_popup(e){$.ajax({url:"/get-contact-popup/",type:"GET",success:function(t){""!=t&&$(e).html(t)},error:function(){}})}function get_sign_up_popup(e){$.ajax({url:"/get-sign-up-popup/",type:"GET",success:function(t){""!=t&&$(e).html(t)},error:function(){}})}function get_sign_in_popup(e){$.ajax({url:"/get-sign-in-popup/",type:"GET",success:function(t){""!=t&&$(e).html(t)},error:function(){}})}function load_reviews(e,t){var a='<div class="bpv-update-wrapper">';a+='<div class="bpv-search-updating center-block" ><div class="ms1">Đang tải dữ liệu</div>',a+='<div class="ms2"><img style="margin-right:15px;" src="/media/icon/loading.gif"><span>Xin đợi trong giây lát...</span></div></div>';var n=$(a).appendTo("body");$(n).center(),$.ajax({url:t,type:"GET",success:function(t){$(n).remove(),$(e).html(t)},error:function(){$(n).remove()}})}function init_review_tab(e,t){if(1==t&&$(e).length){var a=$(e).attr("data-url");$.ajax({url:a,type:"GET",success:function(t){$(e).html(t)},error:function(){$(div).remove()}})}else{$(e+" a").click(function(e){e.preventDefault();{var t=$(this).attr("data-url"),a=this.hash;$(this)}"#tab_reviews"==a&&load_reviews(a,t)});var n=$("#tab").val();if("tab_reviews"==n){n="#"+n,$(document).scrollTop($(e).offset().top),$(e+' a[href="'+n+'"]').tab("show");var a=$('a[href="'+n+'"]').attr("data-url");load_reviews(n,a)}}}function open_review(e){$(document).scrollTop($(e).offset().top);var t="#tab_reviews";if($(e+' a[href="'+t+'"]').tab("show"),"#tab_reviews"==t){var a=$('a[href="#tab_reviews"]').attr("data-url");load_reviews(t,a)}}function get_marketing_popup(){$.ajax({url:"/get-marketing-popup/",type:"POST",cache:!1,success:function(e){""!=e&&($("body").append(e),$(".popup-wrap").click(function(){$(".popup-bg").remove(),$(".popup-wrap").remove()}),$(".popup-close").click(function(){$(".popup-bg").remove(),$(".popup-wrap").remove()}))},error:function(){}})}function get_marketing_box(){$.ajax({url:"/get-marketing-popup/",type:"POST",cache:!1,data:{cfg:"marketing-more-people-more-save"},success:function(e){""!=e&&($("body").append(e),$(".mk-box-close").click(function(){$(".marketing-box").remove()}))},error:function(){}})}function show_link_data_overview(e,t){$("#data_overview").length>0&&($("#data_overview").modal(),$("#data_overview_loading").show(),$("#data_overview_content").hide(),$.ajax({url:"/show-data-overview/",type:"POST",cache:!1,data:{id:e,data_type:t},success:function(e){$("#data_overview_loading").hide(),$("#data_overview_content").html(e),$("#data_overview_content").show()},error:function(){$("#data_overview_content").html("<center>Lỗi kết nối dữ liệu!</center>"),$("#data_overview_content").show()}}))}function set_up_tour_calendar(e){e="undefined"!=typeof e&&e?!0:!1;var t=new Date;t=dateFormat(t),$("#tour_departure_date").length>0&&set_up_calendar("#tour_departure_date",null,e);var a="#checkin_date";$("#departure_id").length>0?$("#departure_id > option").each(function(){a="#checkin_date_"+$(this).val(),$(a).length>0&&(set_up_calendar(a,null,e),$(a).change(function(){a="#"+$(this).attr("id"),get_check_out_date(a,"#stay_night","#checkout_date","#checkout_date_display")}),get_check_out_date(a,"#stay_night","#checkout_date","#checkout_date_display"))}):$(a).length>0&&(set_up_calendar(a,null,e),$(a).change(function(){get_check_out_date(a,"#stay_night","#checkout_date","#checkout_date_display")}),get_check_out_date(a,"#stay_night","#checkout_date","#checkout_date_display")),$("#tour_start_date").length>0&&set_up_calendar("#tour_start_date",null,e)}function set_up_tour_autocomplete(e){e="undefined"!=typeof e&&e?!0:!1;var t=new Bloodhound({datumTokenizer:function(e){return Bloodhound.tokenizers.whitespace(e.name)},queryTokenizer:Bloodhound.tokenizers.whitespace,remote:{url:"/suggest_tour_destinations/?query=%QUERY"}});t.initialize();var a="#tour_destination";$(a).typeahead({minLength:2,highlight:!0,hint:!1},{displayKey:"name",source:t.ttAdapter(),templates:{header:'<span class="lb-header">Quốc Gia/Thành Phố/Điểm Du Lịch</span>'}}).on("typeahead:selected",function(t,n){$("#tour_destination_input").val(n.url_title),$("#des_id").val(n.id),$(a).data("selected_value",$(a).val()),e||add_clear_search(a),$(a).popover("hide")})}function validate_tour_search(){var e="#tour_destination";return""==$.trim($(e).val())?(alert("Xin vui lòng nhập Quốc Gia/Thành Phố/Điểm Du Lịch"),$(e).focus(),$(e).addClass("bpv-input-warning"),!1):!0}function init_tour_search(e,t){t="undefined"!=typeof t&&t?!0:!1,void 0==e&&(e=!1),e&&get_current_search(4);var a="#tour_destination";init_tour_date("#tour_departure_date","",t),0!=$(a).parent().find(".search-choice-close").length||""==$(a).val()||t||add_clear_search(a),$(a).blur(function(){""==$.trim($(a).val())||t||add_clear_search(a)}),$("#dep_id").change(function(){$("#departure").val(""!=$("#dep_id").val()?$("#dep_id option:selected").text():"")}),$(a).on("input",function(){$.trim($(a).val())!=$(a).data("selected_value")&&($("#tour_destination_input").val(""),$("#des_id").val(""),$(".search-choice-close").remove()),$(a).popover("hide")}),$(a).popover({html:!0,trigger:"click",template:'<div class="popover suggestion-des tour-des-suggestion"><div class="arrow"></div><div class="popover-inner"><div class="popover-content"><p></p></div></div></div>',content:$("#tour_des_suggestion").html(),placement:"right"}).on("shown.bs.popover",function(){$(".sg-des").click(function(){$(a).val($(this).attr("data-name")),$(".typeahead").typeahead("val",$(this).attr("data-name")),$("#tour_destination_input").val($(this).attr("data-url-title")),$("#des_id").val($(this).attr("data-id")),$(a).data("selected_value",$(a).val()),add_clear_search(a),$(a).popover("hide"),$(".typeahead").typeahead("close")}),$(".group-name").bpvToggle()})}function init_tour_date(e,t){new Date;""!=t&&$(e).val(t);var a="#btn_"+e.replace("#","");$(a).click(function(){$(e).focus()})}function get_hotline_box(e,t){$.ajax({url:"/get-hotline-box/",type:"POST",cache:!1,data:{display_on:e,on_sidebar:t},success:function(e){""!=e&&$("#hotline_support_box").html(e)},error:function(){$("#hotline_support_box").html("")}})}var Loader=function(){};Loader.prototype={require:function(e,t){this.loadCount=0,this.totalRequired=e.length,this.callback=t;for(var a=0;a<e.length;a++)this.writeScript(e[a])},loaded:function(){this.loadCount++,this.loadCount==this.totalRequired&&"function"==typeof this.callback&&this.callback.call()},writeScript:function(e){var t=this,a=document.createElement("script");
a.type="text/javascript",a.async=!0,a.src=e,a.addEventListener?a.addEventListener("load",function(e){t.loaded(e)},!1):a.onreadystatechange=function(e){a.readyState in{loaded:1,complete:1}&&(a.onreadystatechange=null,t.loaded(e))};var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(a,n)}};var FORMAT_DATE="dd/mm/yyyy",FORMAT_DATE_CALENDAR="dd/mm/yy",dateFormat=function(e){pad=function(e,t){for(e=String(e),t=t||2;e.length<t;)e="0"+e;return e};var t=e.getDate(),a=e.getMonth();a++;var n=e.getFullYear();return pad(t)+"/"+pad(a)+"/"+n},get_JS_Date=function(e){var t=e.split("/");return new Date(parseInt(t[2],10),[parseInt(t[1],10)-1],parseInt(t[0],10),0,0,0,0)};jQuery.fn.center=function(){return this.css("position","absolute"),this.css("top",Math.max(0,($(window).height()-$(this).outerHeight())/2+$(window).scrollTop())+"px"),this.css("left",Math.max(0,($(window).width()-$(this).outerWidth())/2+$(window).scrollLeft())+"px"),this},jQuery.fn.bpvToggle=function(e){$(this).click(function(t){t.preventDefault();var a=$(this).attr("data-target");if(0==$(a).length)return!1;"function"==typeof e&&e.call(this,{id:a});var n=$(".bpv-toggle-icon",$(this));$(a).not(":animated").slideToggle("slow","swing",function(){$(n).hasClass("icon-arrow-right-white")&&$(n).toggleClass("icon-arrow-right-white-up"),$(n).hasClass("icon-chevron-down")&&$(n).toggleClass("icon-chevron-up"),$(n).hasClass("icon-arrow-right-sm")&&$(n).toggleClass("icon-arrow-right-sm-down")})})};