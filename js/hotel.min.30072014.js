function search_hotels_in_waiting_page(t){var a=window.location.hash;""!=a&&void 0!=a&&(a=a.substring(1)),$.ajax({url:t+"?isAjax=1&"+a,type:"GET",cache:!0,data:{},success:function(t){-1!=t.indexOf("[hotel-detail-page]")?(t=t.replace("[hotel-detail-page]",""),window.location=t):-1!=t.indexOf("[search-suggestion]")?(t=t.replace("[search-suggestion]",""),window.location=t):$(".bpv-content").html(t)},error:function(){}})}function search_sort_hotels(t,a){var e=validate_hotel_search();if(e){var r=get_search_sort_params(a);window.location=t+"#"+r,go_position(0),$(".bpv-update-wrapper").show(),$.ajax({url:t+"?isAjax=1&"+r,type:"GET",cache:!0,data:{},success:function(t){-1!=t.indexOf("[hotel-detail-page]")?(t=t.replace("[hotel-detail-page]",""),window.location=t):-1!=t.indexOf("[search-suggestion]")?(t=t.replace("[search-suggestion]",""),window.location=t):$(".bpv-content").html(t)},error:function(){}})}return!1}function redirect_to_search_page(t,a){window.location=t+"#"+a}function get_search_sort_params(t){var a=$("#destination").val();a=encodeURIComponent(a);var e=$("#startdate").val(),r=$("#enddate").val(),n=$("#night").val(),o=$("#oid").val(),i=$("input[name='filter_price\\[\\]']:checked").map(function(){return $(this).val()}).get(),_=$("input[name='filter_star\\[\\]']:checked").map(function(){return $(this).val()}).get(),c=$("input[name='filter_area']:checked").map(function(){return $(this).val()}).get(),s=$("input[name='filter_facility\\[\\]']:checked").map(function(){return $(this).val()}).get(),l=$("#sort_by_value").val(),h="destination="+a;return h=h+"&startdate="+e,h=h+"&night="+n,h=h+"&enddate="+r,""!=o&&(h=h+"&oid="+o),""!=i&&(h=h+"&price="+i),""!=_&&(h=h+"&star="+_),""!=c&&(h=h+"&area="+c),""!=s&&(h=h+"&facility="+s),""!=l&&(h=h+"&sort="+l),void 0!=t&&(h=h+"&page="+t),h}function sort_by(t,a){$("#sort_by_value").val(t),search_sort_hotels(a)}function remove_filter(t,a,e){$("#"+t+"_"+a).prop("checked",!1),search_sort_hotels(e)}function init_hotel_paging(t){$(".pagination a").click(function(){var a=$(this).attr("href");return page=get_url_var("page",a),(""==page||void 0==page)&&(page=0),page=parseInt(page),search_sort_hotels(t,page),!1})}function book_hotel_now(t){var a=!1;return $(".num_room").each(function(){var t=$(this).val();t>0&&(a=!0)}),a||alert(t),a}function select_rooms(t){var a=0,e=0,r=$("#stay_night").val();$(".num_room").each(function(){var n=$(this).val(),o=$(this).attr("room-rate-id");if(n>0){var i=$(this).attr("rate-origin"),_=$(this).attr("rate-sell");if(a+=n*parseInt(i),e+=n*parseInt(_),void 0!=o&&""!=o){$("#total_room_label_"+o).text("Tổng giá "+n+" phòng x "+r+" đêm: ");var c='<span class="bpv-price-origin">'+bpv_format_currency(n*parseInt(i),t)+"</span>";c=c+' <span class="bpv-price-total">'+bpv_format_currency(n*parseInt(_),t)+"</span>",$("#total_room_price_"+o).html(c),$("#select_room_to_book_"+o).hide(),$("#total_room_info_"+o).show()}}else void 0!=o&&""!=o&&($("#select_room_to_book_"+o).show(),$("#total_room_info_"+o).hide())}),e>0?($("#total_rate_label").show(),a!=e&&($("#total_rate_origin").html(bpv_format_currency(a,t)),$("#total_rate_origin").show()),$("#total_rate_sell").html(bpv_format_currency(e,t)),$("#total_rate_sell").show()):($("#total_rate_label").hide(),$("#total_rate_origin").hide(),$("#total_rate_sell").hide())}function select_extra_bed(t){var a=0,e=0;$(".extrabed").each(function(){var r=parseInt($(this).val()),n=$(this).attr("extrabed-rate");n=parseInt(n)*r;var o=$(this).attr("room-index");update_room_rate_with_extrabed(n,o,t),e+=r,a+=n});var r=show_extrabed_on_payment_detail(e,a,t);return r}function update_room_rate_with_extrabed(t,a,e){var r=$("#rate_origin_"+a).attr("rate");void 0!=r&&""!=r&&(r=parseInt(r),r+=t,r=bpv_format_currency(r,e),$("#rate_origin_"+a).html(r));var n=$("#rate_sell_"+a).attr("rate");void 0!=n&&""!=n&&(n=parseInt(n),n+=t,n=bpv_format_currency(n,e),$("#rate_sell_"+a).html(n))}function show_extrabed_on_payment_detail(t,a,e){t>0?($("#nr_extrabed").text(t),$("#total_extrabed").html(bpv_format_currency(a,e)),$("#p_extrabed_detail").show()):$("#p_extrabed_detail").hide();var r=0;$(".room-rate-payment").each(function(){r+=parseInt($(this).attr("rate"))}),$(".surcharge-payment").each(function(){r+=parseInt($(this).attr("rate"))});var n=$("#total_discount").attr("rate");n=void 0==n||""==n?0:parseInt(n);var o=$("#applied_code_discount").attr("rate");o=void 0==o||""==o?0:parseInt(o);var i=r+a-n-o;return $("#total_payment").html(bpv_format_currency(i,e)),i}function update_travel_guests_for_surcharge(t){var a=$("#adults").val(),e=$("#children").val();$(".sur_adults").text(a),$(".sur_children").text(e);var r=parseInt(a)+parseInt(e);$(".sur-info").each(function(){var a=$(this).attr("c-type");if(a=parseInt(a),1==a){var e=$(this).attr("charge");e=parseInt(e);var n=e*r;$(this).html(bpv_format_currency(n,t)),$(this).attr("rate",n)}}),$(".surcharge-payment").each(function(){var a=$(this).attr("c-type");if(a=parseInt(a),1==a){var e=$(this).attr("charge");e=parseInt(e);var n=e*r;$(this).html(bpv_format_currency(n,t)),$(this).attr("rate",n)}}),select_extra_bed(t)}function update_hotel_total_payment(t){var a=select_extra_bed(t);return a}function validate_hotel_check_rate_form(){var t=$("#checkin_date").val();return""==$.trim(t)?($("#checkin_date").focus(),$("#checkin_date").addClass("bpv-input-warning"),alert('Xin vui lòng nhập thông tin "Ngày nhận phòng"'),!1):check_date(t)?!0:($("#checkin_date").focus(),$("#checkin_date").addClass("bpv-input-warning"),alert('"Ngày nhận phòng" phải theo định dạng '+FORMAT_DATE),!1)}